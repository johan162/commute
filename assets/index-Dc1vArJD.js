import{a9 as e,r as N,aa as ze,ab as He}from"./vendor-CXwva4lO.js";import{R as je,B as Se,C as be,X as Ne,Y as ve,T as we,a as Te,b as Ae,S as Ye,c as Be}from"./recharts-8Htpa80n.js";import{E as Ve,a as he,_ as qe}from"./jspdf-TjYnE4-S.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const ye=({label:s,viewName:n,activeView:t,setView:o,Icon:r})=>{const a=t===n;return e.jsxs("button",{onClick:()=>o(n),className:`flex flex-col items-center justify-center w-full py-2 px-1 text-xs sm:text-sm transition-colors duration-200 ${a?"text-cyan-400":"text-gray-400 hover:text-cyan-300"}`,children:[e.jsx(r,{className:"w-6 h-6 mb-1"}),e.jsx("span",{children:s})]})},Ge=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ke=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})}),Qe=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"})}),Ue=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75v.01M12 17.25v.01"})]}),_e=({activeView:s,setView:n})=>e.jsxs("header",{className:"bg-gray-800 shadow-lg sticky top-0 z-10",children:[e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-between items-center py-2",children:e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white tracking-wider",children:"Commute Tracker"})})}),e.jsx("nav",{className:"bg-gray-800/50 border-t border-gray-700",children:e.jsxs("div",{className:"container mx-auto flex justify-around",children:[e.jsx(ye,{label:"Timer",viewName:"main",activeView:s,setView:n,Icon:Ge}),e.jsx(ye,{label:"Stats",viewName:"stats",activeView:s,setView:n,Icon:Ke}),e.jsx(ye,{label:"History",viewName:"history",activeView:s,setView:n,Icon:Qe}),e.jsx(ye,{label:"Settings",viewName:"settings",activeView:s,setView:n,Icon:Ue})]})})]}),Xe=(s,n)=>{const o=s.latitude*Math.PI/180,r=n.latitude*Math.PI/180,a=(n.latitude-s.latitude)*Math.PI/180,i=(n.longitude-s.longitude)*Math.PI/180,l=Math.sin(a/2)*Math.sin(a/2)+Math.cos(o)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},Ze=({workLocation:s,onStop:n,autoStopRadius:t=50,autoRecordWorkLocation:o=!1,onAddWorkLocation:r})=>{const[a,i]=N.useState(!1),[l,m]=N.useState(0),[x,f]=N.useState('Press "Leaving" to start your commute.'),[u,j]=N.useState(null),h=N.useRef(null),R=N.useRef(null);N.useEffect(()=>{const v=localStorage.getItem("commuteStartTime");if(v){const E=parseInt(v,10);i(!0),m((Date.now()-E)/1e3),f("Commute resumed...")}},[]),N.useEffect(()=>(a?h.current=window.setInterval(()=>{const v=localStorage.getItem("commuteStartTime");v&&m((Date.now()-parseInt(v,10))/1e3)},1e3):h.current&&(clearInterval(h.current),h.current=null),()=>{h.current&&clearInterval(h.current)}),[a]);const B=N.useCallback(v=>{if(!a)return;i(!1),h.current&&(clearInterval(h.current),h.current=null),R.current&&(navigator.geolocation.clearWatch(R.current),R.current=null);const E=localStorage.getItem("commuteStartTime"),H=E?parseInt(E,10):Date.now(),k=(Date.now()-H)/1e3;localStorage.removeItem("commuteStartTime"),o&&r?navigator.geolocation.getCurrentPosition(O=>{const{latitude:Y,longitude:C}=O.coords;r({latitude:Y,longitude:C}),f(v||`Commute recorded! Duration: ${Math.round(k)}s. Work location auto-recorded.`),setTimeout(()=>f('Press "Leaving" to start your commute.'),5e3)},O=>{console.error("Failed to record work location automatically:",O),f(v||`Commute recorded! Duration: ${Math.round(k)}s. Failed to auto-record location.`),setTimeout(()=>f('Press "Leaving" to start your commute.'),5e3)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(f(v||`Commute recorded! Duration: ${Math.round(k)}s`),setTimeout(()=>f('Press "Leaving" to start your commute.'),5e3)),n(k),m(0),j(null)},[a,n,o,r]);return N.useEffect(()=>(a&&s&&(f("GPS tracking active..."),R.current=navigator.geolocation.watchPosition(v=>{const E={latitude:v.coords.latitude,longitude:v.coords.longitude},H=Xe(E,s);j(H),f(`Tracking... ${H.toFixed(0)}m to destination.`),H<t&&B("Arrived at work location automatically.")},v=>{console.error("Geolocation error:",v),f("GPS error. Tracking may be unreliable.")},{enableHighAccuracy:!0,maximumAge:0})),()=>{R.current&&navigator.geolocation.clearWatch(R.current)}),[a,s,t,B]),{isRunning:a,elapsedTime:l,startTimer:()=>{if(a)return;const v=Date.now();localStorage.setItem("commuteStartTime",v.toString()),i(!0),m(0),f("Commute started. Have a safe trip!")},stopTimer:B,statusMessage:x,distance:u}},W=({title:s,children:n,headerAction:t})=>e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-xl shadow-lg w-full max-w-2xl mx-auto",children:[s&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s}),t&&e.jsx("div",{className:"flex items-center",children:t})]}),e.jsx("div",{className:"p-4 md:p-6",children:n})]}),Je=s=>{const n=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},et=({onSaveCommute:s,workLocation:n,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:r})=>{const{isRunning:a,elapsedTime:i,startTimer:l,stopTimer:m,statusMessage:x,distance:f}=Ze({workLocation:n,onStop:s,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:r}),u=()=>{l()},j=()=>{m()};return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-6",children:[e.jsx(W,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-400 mb-2",children:"Commute Duration"}),e.jsx("h2",{className:"text-5xl sm:text-7xl md:text-8xl font-mono font-bold tracking-widest text-cyan-400",children:Je(i)})]})}),e.jsx("div",{className:"w-full max-w-sm flex flex-col gap-4",children:a?e.jsx("button",{onClick:j,className:"w-full bg-red-500 hover:bg-red-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Arrive"}):e.jsx("button",{onClick:u,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Leaving"})}),e.jsxs("div",{className:"text-center text-gray-400 mt-4 h-10",children:[e.jsx("p",{children:x}),f!==null&&e.jsxs("p",{children:["Distance to work: ",f.toFixed(0),"m"]})]})]})},tt=({records:s,binSizeMinutes:n})=>{const t=N.useMemo(()=>{if(s.length===0)return[];const r=s.map(x=>x.duration/60),a=Math.max(...r),i={};for(const x of r){const f=Math.floor(x/n)*n,u=f+n,j=`${f}-${u}`;i[j]=(i[j]||0)+1}Object.keys(i).sort((x,f)=>parseInt(x.split("-")[0])-parseInt(f.split("-")[0]));const l=Math.floor(a/n)*n,m=[];for(let x=0;x<=l;x+=n){const f=x+n,u=`${x}-${f}`;m.push({name:u,count:i[u]||0})}return m},[s,n]),o=N.useMemo(()=>{if(t.length===0)return;const r=Math.max(...t.map(a=>a.count));if(r===0)return[0];for(const a of[2,4,6,8,10,20,40,60,80,100]){const i=Math.ceil(r/a);if(i>=3&&i<=6){const l=[];for(let m=0;m<=i;m++)l.push(m*a);return l}}for(const a of[5,10,15,25,50]){const i=Math.ceil(r/a);if(i>=3&&i<=6){const l=[];for(let m=0;m<=i;m++)l.push(m*a);return l}}},[t]);return e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(Se,{data:t,margin:{top:5,right:20,left:-10,bottom:5},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(Ne,{dataKey:"name",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(ve,{allowDecimals:!1,stroke:"#A0AEC0",tick:{fontSize:12},ticks:o,domain:o?[0,o[o.length-1]]:[0,"auto"]}),e.jsx(we,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#63B3ED"},formatter:r=>[`${r} trips`,"Count"],labelFormatter:r=>`Time: ${r} min`}),e.jsx(Te,{dataKey:"count",name:"Trips",children:t.map((r,a)=>e.jsx(Ae,{fill:"#2DD4BF"},`cell-${a}`))})]})})},st=({records:s})=>{const n=N.useMemo(()=>{if(s.length===0)return[];const t={};s.forEach(r=>{const a=new Date(r.date).getHours();t[a]||(t[a]={totalDuration:0,count:0}),t[a].totalDuration+=r.duration,t[a].count++});const o=[];for(let r=0;r<24;r++){const a=t[r];a&&o.push({hour:`${String(r).padStart(2,"0")}:00`,averageDuration:a.totalDuration/a.count/60,count:a.count})}return o},[s]);return n.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No commute data to display."}):e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(Se,{data:n,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(Ne,{dataKey:"hour",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(ve,{dataKey:"averageDuration",unit:"m",stroke:"#A0AEC0",tick:{fontSize:12},width:40}),e.jsx(we,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#81E6D9"},formatter:(t,o,r)=>o==="averageDuration"?[`${t.toFixed(1)} min (average of ${r.payload.count} trips)`,"Duration"]:[t,o],labelFormatter:t=>`Time: ${t}`}),e.jsx(Te,{dataKey:"averageDuration",name:"averageDuration",children:n.map((t,o)=>e.jsx(Ae,{fill:"#81E6D9"},`cell-${o}`))})]})})},nt=s=>s.length===0?0:Math.min(...s),at=s=>s.length===0?0:Math.max(...s),ge=s=>s.length===0?0:s.reduce((t,o)=>t+o,0)/s.length,Ce=s=>{if(s.length===0)return 0;const n=[...s].sort((o,r)=>o-r),t=Math.floor(n.length/2);return n.length%2===0?(n[t-1]+n[t])/2:n[t]},Re=s=>{if(s.length<2)return 0;const n=ge(s),t=s.reduce((o,r)=>o+Math.pow(r-n,2),0)/(s.length-1);return Math.sqrt(t)},Me=(s,n)=>{if(s.length===0)return 0;const t=[...s].sort((l,m)=>l-m),o=n/100*(t.length-1);if(Number.isInteger(o))return t[o];const r=Math.floor(o),a=Math.ceil(o),i=o-r;return t[r]*(1-i)+t[a]*i},Fe=(s,n)=>{if(s.length===0)return 0;const t=[...s].sort((r,a)=>r-a),o=Math.ceil(n/100*t.length)-1;return t[Math.max(0,o)]},Ie=(s,n=90)=>{if(s.length<5)return null;const t=(100-n)/2,o=t,r=100-t;return{low:Me(s,o),high:Me(s,r)}},Le=(s,n=90)=>{if(s.length<5)return null;const t=(100-n)/2,o=t,r=100-t;return{low:Fe(s,o),high:Fe(s,r)}},rt=s=>{const n=s.length;if(n<3)return null;const t=[...s].sort((h,R)=>h-R),o=ge(t),r=t.reduce((h,R)=>h+Math.pow(R-o,2),0);if(r===0)return{W:1,pValue:1,isNormal:!0};const a=new Array(n);for(let h=0;h<n;h++){const R=(h+1-.375)/(n+.25);a[h]=Ee(R)}const i=a.reduce((h,R)=>h+R*R,0),l=1/Math.sqrt(i);let m=0;for(let h=0;h<n;h++)m+=a[h]*t[h];m=m*m*l*l;const x=m/r,f=Math.max(0,Math.min(1,x));if(Math.abs(x-f)>.01)return console.error(`Shapiro-Wilk W statistic out of range: ${x}`),null;const u=ct(f,n),j=u>.05;return{W:f,pValue:u,isNormal:j}};function ot(s){const n=s.length;if(n<3)return[];const t=[...s].sort((i,l)=>i-l),o=ge(t),r=Re(t),a=[];for(let i=0;i<n;i++){const l=(i+1-.5)/n,m=Ee(l),x=(t[i]-o)/r;a.push({theoretical:m,observed:x})}return a}function it(s){if(s.length<3)return 0;const n=s.reduce((a,i)=>a+i.observed,0)/s.length,t=s.reduce((a,i)=>{const l=i.observed-i.theoretical;return a+l*l},0),o=s.reduce((a,i)=>{const l=i.observed-n;return a+l*l},0);if(o===0)return 1;const r=1-t/o;return Math.max(0,Math.min(1,r))}function lt(s){return s>=.99?{rating:"Excellent",color:"text-green-400",description:"Data fits normal distribution very closely"}:s>=.95?{rating:"Very Good",color:"text-green-400",description:"Data fits normal distribution well"}:s>=.9?{rating:"Good",color:"text-blue-400",description:"Data reasonably fits normal distribution"}:s>=.8?{rating:"Moderate",color:"text-yellow-400",description:"Data shows moderate fit to normal distribution"}:s>=.7?{rating:"Fair",color:"text-orange-400",description:"Data has fair fit to normal distribution"}:{rating:"Poor",color:"text-red-400",description:"Data does not fit normal distribution well"}}function Ee(s){const n=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],t=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],o=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],r=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416],a=.02425,i=1-a;if(s<a){const l=Math.sqrt(-2*Math.log(s));return(((((o[0]*l+o[1])*l+o[2])*l+o[3])*l+o[4])*l+o[5])/((((r[0]*l+r[1])*l+r[2])*l+r[3])*l+1)}else if(s<=i){const l=s-.5,m=l*l;return(((((n[0]*m+n[1])*m+n[2])*m+n[3])*m+n[4])*m+n[5])*l/(((((t[0]*m+t[1])*m+t[2])*m+t[3])*m+t[4])*m+1)}else{const l=Math.sqrt(-2*Math.log(1-s));return-(((((o[0]*l+o[1])*l+o[2])*l+o[3])*l+o[4])*l+o[5])/((((r[0]*l+r[1])*l+r[2])*l+r[3])*l+1)}}function ct(s,n){if(s<=0||s>1)return 0;if(s===1)return 1;const t={20:{p01:.868,p05:.905,p10:.918},25:{p01:.888,p05:.918,p10:.928},30:{p01:.9,p05:.927,p10:.935},35:{p01:.91,p05:.934,p10:.941},40:{p01:.917,p05:.94,p10:.945},50:{p01:.927,p05:.947,p10:.951},60:{p01:.935,p05:.952,p10:.956},70:{p01:.941,p05:.956,p10:.959},80:{p01:.945,p05:.959,p10:.962},90:{p01:.949,p05:.962,p10:.964},100:{p01:.952,p05:.964,p10:.966},110:{p01:.954,p05:.966,p10:.967},120:{p01:.956,p05:.967,p10:.969},130:{p01:.958,p05:.968,p10:.97},140:{p01:.959,p05:.969,p10:.971},150:{p01:.96,p05:.97,p10:.972},160:{p01:.961,p05:.971,p10:.973},170:{p01:.962,p05:.972,p10:.974},180:{p01:.963,p05:.973,p10:.974},190:{p01:.964,p05:.973,p10:.975},200:{p01:.965,p05:.974,p10:.975},210:{p01:.965,p05:.974,p10:.976},220:{p01:.966,p05:.975,p10:.976},230:{p01:.966,p05:.975,p10:.977},240:{p01:.967,p05:.976,p10:.977},250:{p01:.967,p05:.976,p10:.978}};let o=20,r=Math.abs(n-20);for(const i of Object.keys(t).map(Number)){const l=Math.abs(n-i);l<r&&(r=l,o=i)}const a=t[o];if(s>=a.p10){const i=1-a.p10;return .1+(s-a.p10)/i*.9}else if(s>=a.p05){const i=a.p10-a.p05;return .05+(s-a.p05)/i*.05}else if(s>=a.p01){const i=a.p05-a.p01;return .01+(s-a.p01)/i*.04}else{const i=a.p01;return s/i*.01}}function We(s){return .5*(1+dt(s/Math.sqrt(2)))}function dt(s){const n=.254829592,t=-.284496736,o=1.421413741,r=-1.453152027,a=1.061405429,i=.3275911,l=s>=0?1:-1;s=Math.abs(s);const m=1/(1+i*s),x=1-((((a*m+r)*m+o)*m+t)*m+n)*m*Math.exp(-s*s);return l*x}function mt(s){const n=s.length;if(n<10)return null;let t=0;for(let f=0;f<n-1;f++)for(let u=f+1;u<n;u++){const j=s[u]-s[f];j>0?t++:j<0&&t--}const o=2*t/(n*(n-1)),r=n*(n-1)*(2*n+5)/18;let a;t>1?a=(t-1)/Math.sqrt(r):t<-1?a=(t+1)/Math.sqrt(r):a=t/Math.sqrt(r);const l=2*(1-We(Math.abs(a)));let m;l<.05?m=t>0?"increasing":"decreasing":m="no trend";let x;return l<.01?x="strong":l<.05?x="moderate":l<.1?x="weak":x="none",{S:t,tau:o,zScore:a,pValue:l,trend:m,significance:x}}function ht(s){const n=s.length;if(n<10)return null;const t=Ce(s),o=s.map(h=>h>t?1:0),r=o.filter(h=>h===1).length,a=o.filter(h=>h===0).length;if(r===0||a===0)return null;let i=1;for(let h=1;h<n;h++)o[h]!==o[h-1]&&i++;const l=2*r*a/(r+a)+1,m=2*r*a*(2*r*a-r-a)/(Math.pow(r+a,2)*(r+a-1));let x;i>l?x=(i-.5-l)/Math.sqrt(m):i<l?x=(i+.5-l)/Math.sqrt(m):x=0;const f=2*(1-We(Math.abs(x)));let u;f<.05?u=i<l?"clustered":"oscillating":u="random";let j;return f<.01?j="strong":f<.05?j="moderate":f<.1?j="weak":j="none",{runs:i,expectedRuns:l,zScore:x,pValue:f,pattern:u,significance:j}}const ee=s=>{if(isNaN(s)||s<0)return"N/A";const n=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},ut=s=>{const n=["ID","Date","Time","Duration (s)"],t=s.map(i=>{const l=new Date(i.date),m=l.toLocaleDateString(),x=l.toLocaleTimeString("en-GB",{hour12:!1});return[i.id,m,x,i.duration.toFixed(2)]});let o="data:text/csv;charset=utf-8,"+n.join(",")+`
`+t.map(i=>i.join(",")).join(`
`);const r=encodeURI(o),a=document.createElement("a");a.setAttribute("href",r),a.setAttribute("download","commute_records.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},xt=(s,n)=>{const t=new Ve,o=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Time Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const r=`Report Date: ${o}`,a=t.getTextWidth(r);t.text(r,196-a,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Statistics Summary",14,35);const i=s.map(d=>d.duration),l=s.length>=5?Ie(i,90):null,m=s.length>=5?Le(i,90):null,x=[["Total Trips",s.length.toString()],["Min Duration",ee(n.min)],["Max Duration",ee(n.max)],["Mean (Average)",ee(n.mean)],["Median",ee(n.median)],["Standard Deviation",ee(n.stdDev)]];l&&m?(x.push(["",""]),x.push(["90% Confidence Interval (Interpolated)",""]),x.push(["  • Low (5th percentile)",ee(l.low)]),x.push(["  • High (95th percentile)",ee(l.high)]),x.push(["90% Confidence Interval (Nearest Rank)",""]),x.push(["  • Low (5th percentile)",ee(m.low)]),x.push(["  • High (95th percentile)",ee(m.high)])):(x.push(["",""]),x.push(["90% Confidence Intervals","Requires 5+ records"])),t.setFont("helvetica","normal"),he(t,{startY:40,head:[["Metric","Value"]],body:x,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const u=(()=>{const d=s.reduce((b,y)=>b+y.duration,0),g=new Date,S=g.getFullYear(),F=g.getMonth(),A=g.toISOString().split("T")[0],$=b=>{const y=new Date(b),U=y.getDay(),te=y.getDate()-U+(U===0?-6:1);return y.setDate(te),y.toISOString().split("T")[0]},P=$(g),q=s.filter(b=>new Date(b.date).toISOString().split("T")[0]===A).reduce((b,y)=>b+y.duration,0),J=s.filter(b=>$(new Date(b.date))===P).reduce((b,y)=>b+y.duration,0),ae=s.filter(b=>{const y=new Date(b.date);return y.getFullYear()===S&&y.getMonth()===F}).reduce((b,y)=>b+y.duration,0),_=s.filter(b=>new Date(b.date).getFullYear()===S).reduce((b,y)=>b+y.duration,0);return{dayTotal:q,weekTotal:J,monthTotal:ae,yearTotal:_,totalTime:d}})(),j=d=>{const g=Math.floor(d/3600),S=Math.floor(d%3600/60);return g===0?`${S} minutes`:`${g} hours ${S} minutes`};let h=t.lastAutoTable.finalY+15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Total Commute Time",14,h),t.setFont("helvetica","normal"),he(t,{startY:h+5,head:[["Period","Total Time"]],body:[["Today",j(u.dayTotal)],["This Week",j(u.weekTotal)],["This Month",j(u.monthTotal)],["This Year",j(u.yearTotal)],["All Time",j(u.totalTime)]],theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Charts & Analysis",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const R=`Report Date: ${o}`,B=t.getTextWidth(R);t.text(R,196-B,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Commute Duration Distribution",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows how your commute times are distributed across different duration ranges.",14,45);const Q=5,v={};s.forEach(d=>{const g=Math.floor(d.duration/60),S=Math.floor(g/Q)*Q,F=S+Q,A=`${S}-${F}`;v[A]=(v[A]||0)+1});const E=Object.entries(v).sort(([d],[g])=>parseInt(d.split("-")[0])-parseInt(g.split("-")[0])),H=210,k=153,O=(H-k)/2,Y=60,C=80,G=Math.max(...E.map(([,d])=>d)),V=k/E.length,oe=(d=>{if(d===0)return{values:[0,0,0,0,0],numDivisions:4};const g=[2,4,6,8,10,20,40,60,80,100,200];for(const b of g){const y=Math.ceil(d/b);if(y>=3&&y<=6){const U=[],te=y*b;for(let K=0;K<=y;K++)U.push(te*K/y);return{values:U,numDivisions:y}}}const S=[5,15,25,50,150,250];for(const b of S){const y=Math.ceil(d/b);if(y>=3&&y<=6){const U=[],te=y*b;for(let K=0;K<=y;K++)U.push(te*K/y);return{values:U,numDivisions:y}}}const F=4,A=d/F,$=Math.pow(10,Math.floor(Math.log10(A))),P=A/$;let q;P<=1?q=1:P<=2?q=2:P<=5?q=5:q=10;const J=q*$,ae=Math.ceil(d/J)*J,_=[];for(let b=0;b<=F;b++)_.push(ae*b/F);return{values:_,numDivisions:F}})(G),ce=oe.values,se=oe.numDivisions;t.setFillColor(249,250,251),t.rect(O,Y,k,C,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(O,Y,k,C,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let d=1;d<se;d++){const g=Y+C-C*d/se;t.line(O,g,O+k,g)}E.forEach(([d,g],S)=>{const F=ce[ce.length-1],A=F>0?g/F*C:0,$=O+S*V+2,P=Y+C-A;t.setFillColor(200,200,200),t.rect($+1,P+1,V-4,A,"F"),t.setFillColor(25,51,102),t.rect($,P,V-4,A,"F"),t.setDrawColor(15,35,70),t.setLineWidth(.5),t.rect($,P,V-4,A,"S"),A>15?(t.setFontSize(8),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(g.toString(),$+(V-4)/2,P+A/2,{align:"center"})):A>5&&(t.setFontSize(7),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(g.toString(),$+(V-4)/2,P-2,{align:"center"}))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let d=0;d<=se;d++){const g=ce[d],S=Y+C-C*d/se,F=g%1===0?g.toString():g.toFixed(1);t.text(F,O-5,S+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),E.forEach(([d],g)=>{const S=O+g*V+V/2,F=Y+C+8;t.text(d.replace("-","–")+"m",S,F,{align:"center",angle:45})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",O-10,Y+C/2,{align:"center",angle:90}),t.text("Duration Range (minutes)",O+k/2,Y+C+20,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Duration Histogram",O+k/2,Y-5,{align:"center"});const de=E.map(([d,g])=>[d+" min",g.toString()]);h=Y+C+35,he(t,{startY:h,head:[["Duration Range","Number of Commutes"]],body:de,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),h=t.lastAutoTable.finalY+15,h>200&&(t.addPage(),h=20),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Time of Day Breakdown",14,h),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows when you typically commute throughout the day.",14,h+10);const X=["Early Morning (5-9)","Morning (9-12)","Afternoon (12-17)","Evening (17-21)","Night (21-5)"],ne=[[216,191,140],[147,171,129],[108,141,162],[133,119,144],[89,107,125]],Z={};X.forEach(d=>{Z[d]=0}),s.forEach(d=>{const g=new Date(d.date).getHours();let S="";g>=5&&g<9?S="Early Morning (5-9)":g>=9&&g<12?S="Morning (9-12)":g>=12&&g<17?S="Afternoon (12-17)":g>=17&&g<21?S="Evening (17-21)":S="Night (21-5)",Z[S]=(Z[S]||0)+1});const I=X.map(d=>[d,Z[d]]),z=Math.max(...I.map(([,d])=>d)),fe=(d=>{if(d===0)return{values:[0,0,0,0,0],numDivisions:4};const g=[2,4,6,8,10,20,40,60,80,100,200];for(const b of g){const y=Math.ceil(d/b);if(y>=3&&y<=6){const U=[],te=y*b;for(let K=0;K<=y;K++)U.push(te*K/y);return{values:U,numDivisions:y}}}const S=[5,15,25,50,150,250];for(const b of S){const y=Math.ceil(d/b);if(y>=3&&y<=6){const U=[],te=y*b;for(let K=0;K<=y;K++)U.push(te*K/y);return{values:U,numDivisions:y}}}const F=4,A=d/F,$=Math.pow(10,Math.floor(Math.log10(A))),P=A/$;let q;P<=1?q=1:P<=2?q=2:P<=5?q=5:q=10;const J=q*$,ae=Math.ceil(d/J)*J,_=[];for(let b=0;b<=F;b++)_.push(ae*b/F);return{values:_,numDivisions:F}})(z),c=fe.values,p=fe.numDivisions,w=153,T=(H-w)/2,D=h+25,L=70,M=w/I.length;t.setFillColor(249,250,251),t.rect(T,D,w,L,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(T,D,w,L,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let d=1;d<p;d++){const g=D+L-L*d/p;t.line(T,g,T+w,g)}I.forEach(([d,g],S)=>{const F=c[c.length-1],A=F>0?g/F*L:0,$=T+S*M+4,P=D+L-A;t.setFillColor(200,200,200),t.rect($+1,P+1,M-8,A,"F");const[q,J,ae]=ne[S];t.setFillColor(q,J,ae),t.rect($,P,M-8,A,"F"),t.setDrawColor(q*.7,J*.7,ae*.7),t.setLineWidth(.5),t.rect($,P,M-8,A,"S");const _=g;_>0&&(A>15?(t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(_.toString(),$+(M-8)/2,P+A/2,{align:"center"})):(t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(_.toString(),$+(M-8)/2,P-2,{align:"center"})))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let d=0;d<=p;d++){const g=c[d],S=D+L-L*d/p,F=g%1===0?g.toString():g.toFixed(1);t.text(F,T-5,S+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),I.forEach(([d],g)=>{const S=T+g*M+M/2,F=D+L+8,A=d.split(" ")[0]+`
`+d.match(/\(([^)]+)\)/)?.[1];t.text(A,S,F,{align:"center"})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",T-10,D+L/2,{align:"center",angle:90}),t.text("Time of Day",T+w/2,D+L+22,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Time Distribution by Period",T+w/2,D-5,{align:"center"});const ie=I.filter(([,d])=>d>0).sort(([,d],[,g])=>g-d).map(([d,g])=>[d,g.toString()]);h=D+L+35,ie.length>0&&he(t,{startY:h,head:[["Time Period","Number of Commutes"]],body:ie,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Recent Commute Records",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const me=`Report Date: ${o}`,Oe=t.getTextWidth(me);t.text(me,196-Oe,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Latest Commute Records",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows your most recent commute records in chronological order.",14,45);const $e=s.slice(0,25);h=55,he(t,{startY:h,head:[["Date","Time","Duration"]],body:$e.map(d=>{const g=new Date(d.date);return[g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),g.toLocaleTimeString("en-GB",{hour12:!1}),ee(d.duration)]}),theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const ke=t.internal.getNumberOfPages();for(let d=1;d<=ke;d++)t.setPage(d),t.setFontSize(10),t.setFont("helvetica","italic"),t.text(`Page ${d} of ${ke}`,t.internal.pageSize.getWidth()/2,t.internal.pageSize.getHeight()-10,{align:"center"});t.save(`commute_report_${new Date().toISOString().split("T")[0]}.pdf`)},xe=({children:s,variant:n="primary",...t})=>{const o="font-bold py-2 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md",r={primary:"bg-cyan-500 hover:bg-cyan-600 text-white",secondary:"bg-gray-600 hover:bg-gray-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white"};return e.jsx("button",{className:`${o} ${r[n]}`,...t,children:s})},re=s=>{if(isNaN(s)||s<0)return"N/A";const n=Math.floor(s/60),t=Math.floor(s%60);return`${n}m ${t}s`},gt=({records:s,stats:n,includeWeekends:t})=>{const[o,r]=N.useState(5),[a,i]=N.useState("median"),[l,m]=N.useState(""),[x,f]=N.useState(""),[u,j]=N.useState(""),[h,R]=N.useState(""),B=c=>c.toISOString().split("T")[0],Q=c=>{const p=new Date(c),w=p.getDay(),T=p.getDate()-w+(w===0?-6:1);return new Date(p.setDate(T))},v=N.useMemo(()=>{if(s.length===0)return{days:[],weeks:[],months:[],years:[]};const c=new Set,p=new Set,w=new Set,T=new Set;return s.forEach(D=>{const L=new Date(D.date);c.add(B(L));const M=Q(L);p.add(B(M));const ie=`${L.getFullYear()}-${String(L.getMonth()+1).padStart(2,"0")}`;w.add(ie),T.add(L.getFullYear().toString())}),{days:Array.from(c).sort().reverse(),weeks:Array.from(p).sort().reverse(),months:Array.from(w).sort().reverse(),years:Array.from(T).sort().reverse()}},[s]),E=(c,p)=>c==="total"?s.reduce((T,D)=>T+D.duration,0):s.filter(T=>{const D=new Date(T.date);switch(c){case"day":return p?B(D)===p:!1;case"week":if(!p)return!1;const L=Q(D);return B(L)===p;case"month":return p?`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}`===p:!1;case"year":return p?D.getFullYear().toString()===p:!1;default:return!1}}).reduce((T,D)=>T+D.duration,0),H=c=>{if(isNaN(c)||c<0)return"N/A";const p=Math.floor(c/3600),w=Math.floor(c%3600/60);return p===0?`${w}m`:`${p}h ${w}m`},k=c=>{const[p,w]=c.split("-");return new Date(parseInt(p),parseInt(w)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})},O=c=>new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Y=l?E("day",l):0,C=x?E("week",x):0,G=u?E("month",u):0,V=h?E("year",h):0,pe=E("total");if(N.useMemo(()=>{v.days.length>0&&!l&&m(v.days[0]),v.weeks.length>0&&!x&&f(v.weeks[0]),v.months.length>0&&!u&&j(v.months[0]),v.years.length>0&&!h&&R(v.years[0])},[v,l,x,u,h]),!n)return e.jsx(W,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Not Enough Data"}),e.jsx("p",{className:"text-gray-400",children:"Complete at least one commute to see your stats."})]})});const oe=()=>{ut(s)},ce=()=>{n&&xt(s,n)},se=N.useMemo(()=>{if(s.length<5)return null;const c=s.map(p=>p.duration);return Ie(c,90)},[s]),de=N.useMemo(()=>{if(s.length<5)return null;const c=s.map(p=>p.duration);return Le(c,90)},[s]),X=N.useMemo(()=>{if(s.length<20)return null;const c=s.map(p=>p.duration);return rt(c)},[s]),ne=N.useMemo(()=>{if(s.length<10)return null;const c=s.map(M=>M.duration),p=ot(c),w=Math.min(...p.map(M=>Math.min(M.theoretical,M.observed))),T=Math.max(...p.map(M=>Math.max(M.theoretical,M.observed))),D=30,L=[];for(let M=0;M<D;M++){const ie=M/(D-1),me=w+ie*(T-w);L.push({theoretical:me,observed:me,isReferenceLine:!0})}return{data:p.map(M=>({...M,isReferenceLine:!1})),referenceLine:L,rawData:p}},[s]),Z=N.useMemo(()=>{if(!ne)return null;const c=it(ne.rawData),p=lt(c);return{rSquared:c,interpretation:p}},[ne]),I=N.useMemo(()=>{if(s.length<10)return null;const c=s.map(p=>p.duration);return mt(c)},[s]),z=N.useMemo(()=>{if(s.length<10)return null;const c=s.map(p=>p.duration);return ht(c)},[s]),De=N.useMemo(()=>{const c=t?["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:["Mon","Tue","Wed","Thu","Fri"],p={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]};return s.forEach(w=>{const D=new Date(w.date).getDay(),M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][D];p[M]&&p[M].push(w.duration)}),c.map(w=>{const T=p[w];if(T.length===0)return{day:w,value:0,count:0};const D=a==="mean"?ge(T):Ce(T);return{day:w,value:D/60,count:T.length}})},[s,t,a]),fe=`Statistics Summary - ${s.length} records`;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(W,{title:fe,children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 text-center",children:[e.jsx(ue,{label:"Total Trips",value:s.length}),e.jsx(ue,{label:"Min Time",value:re(n.min)}),e.jsx(ue,{label:"Max Time",value:re(n.max)}),e.jsx(ue,{label:"Average",value:re(n.mean)}),e.jsx(ue,{label:"Median",value:re(n.median)})]})}),e.jsx(W,{title:"90% Confidence Interval (Interpolated)",children:e.jsx("div",{className:"text-center",children:se?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this range, interpolated values might not exist exactly"}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(se.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(se.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(W,{title:"90% Confidence Interval (Nearest Rank)",children:e.jsx("div",{className:"text-center",children:de?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this time range, the closest actual times are used."}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(de.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(de.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(W,{title:"Normality Test (Shapiro-Wilk)",children:e.jsx("div",{className:"text-center",children:X?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Tests whether commute times follow a normal (bell curve) distribution"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"W Statistic"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:X.W.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 0-1 (closer to 1 = more normal)"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"p-value"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:X.pValue.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Significance threshold: 0.05"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Distribution"}),e.jsx("p",{className:`text-2xl font-bold ${X.isNormal?"text-green-400":"text-yellow-400"}`,children:X.isNormal?"✓ Normal":"⚠ Not Normal"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:X.isNormal?"Data fits normal distribution":"Data deviates from normal"})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Interpretation:"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:X.isNormal?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Your commute times appear to follow a normal distribution (p > 0.05). This suggests that most of your commutes cluster around the average, with fewer extremely short or long commutes. Statistical methods assuming normality are appropriate for your data."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-yellow-400",children:"⚠"})," Your commute times do not follow a normal distribution (p ≤ 0.05). This could indicate consistent factors affecting your commute (traffic patterns, weather, route changes) or the presence of outliers. Consider using non-parametric statistical methods."]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • α = 0.05 significance level"]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 20 or more records for normality test"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 20 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Shapiro-Wilk test is most reliable with at least 20 samples"})]})})}),e.jsx(W,{title:"Q-Q Plot (Quantile-Quantile)",children:e.jsx("div",{className:"text-center",children:ne?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Visual assessment of normality - points should follow the diagonal line"}),e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(Ye,{data:[...ne.data,...ne.referenceLine],margin:{top:20,right:50,left:20,bottom:35},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(Ne,{type:"number",dataKey:"theoretical",stroke:"#9CA3AF",style:{fontSize:"0.875rem"},label:{value:"Theoretical Quantiles (Standard Normal)",position:"insideBottom",offset:-5,style:{fill:"#9CA3AF",fontSize:"0.8rem"}},domain:["dataMin","dataMax"],allowDataOverflow:!1,tickCount:7,tickFormatter:c=>c.toFixed(1)}),e.jsx(ve,{type:"number",dataKey:"observed",stroke:"#9CA3AF",style:{fontSize:"0.875rem"},label:{value:"Sample Quantiles (Standardized)",angle:-90,position:"insideLeft",offset:0,style:{fill:"#9CA3AF",textAnchor:"middle",fontSize:"0.8rem"}},domain:["dataMin","dataMax"],allowDataOverflow:!1,tickCount:7,tickFormatter:c=>c.toFixed(1)}),e.jsx(we,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#F3F4F6"},formatter:(c,p)=>[c.toFixed(3),p==="theoretical"?"Theoretical":"Observed"],labelStyle:{color:"#9CA3AF"}}),e.jsx(Be,{dataKey:"observed",fill:"#06B6D4",strokeWidth:1,stroke:"#0891B2",shape:c=>{const{cx:p,cy:w,payload:T}=c;return T?.isReferenceLine?e.jsx("circle",{cx:p,cy:w,r:1,fill:"#EF4444",stroke:"#EF4444"}):e.jsx("circle",{cx:p,cy:w,r:3,fill:"#06B6D4",stroke:"#0891B2",strokeWidth:1})}})]})})}),Z&&e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg mt-4 text-left",children:[e.jsxs("div",{className:"grid grid-cols-[1fr,auto] gap-4 mb-3",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300",children:"R² (Coefficient of Determination)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Measures how well data fits normal distribution"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:Z.rSquared.toFixed(4)}),e.jsx("p",{className:`text-sm font-semibold ${Z.interpretation.color} mt-1`,children:Z.interpretation.rating})]})]}),e.jsx("p",{className:"text-xs text-gray-400 text-left",children:Z.interpretation.description}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-left",children:"R² = 1.0 indicates perfect fit to normal distribution. Values closer to 1.0 suggest better normality."})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left mt-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"How to interpret this plot:"}),e.jsxs("div",{className:"text-xs text-gray-400 space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-red-400",children:"Red dashed line:"})," Perfect normal distribution reference line"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-cyan-400",children:"Blue dots:"})," Your actual commute time data points"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"If points closely follow the red line:"})," Your data is approximately normally distributed"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"If points curve away from the line:"})," Your data deviates from normality"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"S-shaped curve:"})," Data has heavier tails than normal distribution"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reverse S-curve:"})," Data has lighter tails than normal distribution"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Points scattered randomly:"})," Data may have outliers or multiple modes"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Based on ",s.length," standardized commute times"]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for Q-Q plot"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"Q-Q plots are most informative with at least 10 data points"})]})})}),e.jsx(W,{title:"Total Commute Time",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Day"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:H(Y)}),e.jsx("select",{value:l,onChange:c=>m(c.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.days.map(c=>e.jsx("option",{value:c,children:new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},c))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Week"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:H(C)}),e.jsx("select",{value:x,onChange:c=>f(c.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.weeks.map(c=>e.jsxs("option",{value:c,children:["Week of ",O(c)]},c))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Month"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:H(G)}),e.jsx("select",{value:u,onChange:c=>j(c.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.months.map(c=>e.jsx("option",{value:c,children:k(c)},c))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Year"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:H(V)}),e.jsx("select",{value:h,onChange:c=>R(c.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.years.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Total Time"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:H(pe)}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Since start"})]})]})}),e.jsxs(W,{title:"Commute Duration Distribution",children:[e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(tt,{records:s,binSizeMinutes:o})}),e.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-2",children:[e.jsx("label",{htmlFor:"binSize",className:"text-sm text-gray-400",children:"Bin Size (minutes):"}),e.jsxs("select",{id:"binSize",value:o,onChange:c=>r(Number(c.target.value)),className:"bg-gray-700 border border-gray-600 rounded-md p-1 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:1,children:"1"}),e.jsx("option",{value:2,children:"2"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"})]})]})]}),e.jsx(W,{title:"Commute Time by Day of Week",children:e.jsx("div",{className:"text-center",children:s.length>=5?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:[a==="median"?"Median":"Average"," commute time for each day"]}),e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(je,{width:"100%",height:"100%",children:e.jsxs(Se,{data:De,margin:{top:10,right:30,left:0,bottom:20},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(Ne,{dataKey:"day",stroke:"#9CA3AF",style:{fontSize:"0.875rem"}}),e.jsx(ve,{stroke:"#9CA3AF",style:{fontSize:"0.875rem"},label:{value:"Minutes",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),e.jsx(we,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#F3F4F6"},formatter:(c,p,w)=>[`${c.toFixed(1)} min (${w.payload.count} commutes)`,a==="median"?"Median":"Average"],labelStyle:{color:"#9CA3AF"}}),e.jsx(Te,{dataKey:"value",fill:"#06B6D4",radius:[8,8,0,0]})]})})}),e.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-2",children:[e.jsx("label",{htmlFor:"weekdayMetric",className:"text-sm text-gray-400",children:"Show:"}),e.jsxs("select",{id:"weekdayMetric",value:a,onChange:c=>i(c.target.value),className:"bg-gray-700 border border-gray-600 rounded-md p-1 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"median",children:"Median"}),e.jsx("option",{value:"mean",children:"Average"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:t?"Showing all days of the week. Adjust in Settings to hide weekends.":"Showing weekdays only (Mon-Fri). Enable weekends in Settings to see Sat-Sun."})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records for weekly analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(W,{title:"Trend Analysis (Mann-Kendall Test)",children:e.jsx("div",{className:"text-center",children:I?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analyzes whether your commute times are getting longer, shorter, or staying stable over time"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Trend Direction"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[I.trend==="increasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📈"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:"Getting Longer"})]}),I.trend==="decreasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📉"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Getting Shorter"})]}),I.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"➡️"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Stable"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[I.trend==="increasing"&&"Your commute times show an upward trend",I.trend==="decreasing"&&"Your commute times show a downward trend",I.trend==="no trend"&&"No significant trend detected"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Confidence Level"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[I.significance==="strong"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"💪"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Very Strong"})]}),I.significance==="moderate"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"👍"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:"Moderate"})]}),I.significance==="weak"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤔"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:"Weak"})]}),I.significance==="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤷"}),e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Not Significant"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["p-value: ",I.pValue.toFixed(4)]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[I.trend==="increasing"&&I.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-400",children:"⚠️"})," Your commute times are trending ",e.jsx("strong",{children:"upward"}),". This could indicate increasing traffic congestion, seasonal changes, or route deterioration. Consider exploring alternative routes or adjusting your departure time."]}),I.trend==="decreasing"&&I.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Great news! Your commute times are trending ",e.jsx("strong",{children:"downward"}),". This suggests improvements in traffic flow, better route choices, or favorable seasonal changes. Keep up whatever you're doing!"]}),I.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"➡️"})," Your commute times remain ",e.jsx("strong",{children:"stable"})," over time. This consistency suggests predictable traffic patterns and reliable route conditions. Good for planning your schedule!"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • Kendall's τ = ",I.tau.toFixed(3)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for trend analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Mann-Kendall test detects monotonic trends in time series data"})]})})}),e.jsx(W,{title:"Pattern Analysis (Runs Test)",children:e.jsx("div",{className:"text-center",children:z?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Detects whether your commute times follow a random pattern or show clustering/oscillation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Pattern Type"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[z.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🎲"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Random"})]}),z.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📦"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:"Clustered"})]}),z.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🌊"}),e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:"Oscillating"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[z.pattern==="random"&&"No predictable pattern detected",z.pattern==="clustered"&&"Similar times grouped together",z.pattern==="oscillating"&&"Alternating fast/slow pattern"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Runs Analysis"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:["Observed: ",e.jsx("span",{className:"font-bold text-cyan-400",children:z.runs})]}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Expected: ",e.jsx("span",{className:"font-bold text-gray-400",children:z.expectedRuns.toFixed(1)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[z.significance==="strong"&&"(Very Strong Evidence)",z.significance==="moderate"&&"(Moderate Evidence)",z.significance==="weak"&&"(Weak Evidence)",z.significance==="none"&&"(Not Statistically Significant)"]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[z.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"🎲"})," Your commute times appear ",e.jsx("strong",{children:"random"}),", with no clear pattern of clustering or alternation. This is typical when traffic conditions vary independently from day to day. Each commute is relatively unpredictable."]}),z.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-orange-400",children:"📦"})," Your commute times show ",e.jsx("strong",{children:"clustering"}),", meaning you tend to have stretches of similar commute times (several fast days followed by several slow days). This could indicate weekly patterns, weather impacts, or consistent schedule changes."]}),z.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-purple-400",children:"🌊"})," Your commute times show an ",e.jsx("strong",{children:"oscillating pattern"}),", alternating between faster and slower commutes more than expected by chance. This could suggest alternating schedules, every-other-day traffic patterns, or behavioral factors affecting your timing."]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • p-value: ",z.pValue.toFixed(4)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for pattern analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Runs Test detects non-random patterns in sequential data"})]})})}),e.jsx(W,{title:"Time of Day Breakdown",children:e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(st,{records:s})})}),e.jsx(W,{title:"Export Data",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsx("p",{className:"text-gray-400 flex-grow text-center sm:text-left mb-4 sm:mb-0",children:"Export your commute history as a CSV or a PDF summary report."}),e.jsxs("div",{className:"flex gap-4 flex-shrink-0",children:[e.jsx(xe,{onClick:oe,children:"Export to CSV"}),e.jsx(xe,{onClick:ce,children:"Export to PDF"})]})]})})]})},ue=({label:s,value:n})=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:n})]}),pt=s=>{if(isNaN(s)||s<0)return"N/A";const n=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return[n>0?`${n}h`:"",t>0?`${t}m`:"",`${o}s`].filter(Boolean).join(" ")||"0s"},ft=(s,n)=>{if(!n||n===0)return"hsl(210, 15%, 50%)";const t=n*.5,o=n*1.5;return`hsl(${120-(Math.max(t,Math.min(o,s))-t)/(o-t)*120}, 70%, 45%)`},yt=({record:s,median:n,isEditMode:t,isSelected:o,onSelect:r})=>{const a=n?ft(s.duration,n):"hsl(210, 15%, 50%)";return e.jsxs("li",{className:"py-4 px-2 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-700/50 rounded-lg transition-colors duration-200",children:[t&&e.jsx("div",{className:"flex items-center mr-4",children:e.jsx("input",{type:"checkbox",checked:o,onChange:i=>r(s.id,i.target.checked),className:"w-4 h-4 text-red-600 bg-gray-700 border-gray-600 rounded focus:ring-red-500 focus:ring-2"})}),e.jsxs("div",{className:"flex-1 mb-2 sm:mb-0 pr-4",children:[e.jsx("p",{className:"font-semibold text-gray-200",children:pt(s.duration)}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(s.date).toLocaleString("en-GB",{hour12:!1})})]}),e.jsx("div",{className:"w-full sm:w-1/2 h-2.5 bg-gray-600 rounded-full overflow-hidden",title:"Comparison to median commute time",children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:a,width:"100%"}})})]})},jt=({records:s,median:n,onDeleteRecords:t})=>{const[o,r]=N.useState(!1),[a,i]=N.useState(new Set);if(s.length===0)return e.jsx(W,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No History Yet"}),e.jsx("p",{className:"text-gray-400",children:"Your completed commutes will appear here."})]})});const l=()=>{r(!o),i(new Set)},m=(u,j)=>{const h=new Set(a);j?h.add(u):h.delete(u),i(h)},x=()=>{if(a.size===0){alert("Please select at least one record to delete.");return}const u=a.size,j=`Are you sure you want to delete ${u} selected record${u===1?"":"s"}? This action cannot be undone.`;window.confirm(j)&&(t(Array.from(a)),i(new Set),r(!1))},f=()=>{a.size===s.length?i(new Set):i(new Set(s.map(u=>u.id)))};return e.jsxs(W,{title:"Commute History",headerAction:e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&a.size>0&&e.jsx("button",{onClick:f,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:a.size===s.length?"Deselect All":"Select All"}),e.jsx("button",{onClick:l,className:"p-2 text-gray-400 hover:text-gray-200 transition-colors",title:o?"Exit edit mode":"Edit records",children:o?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),children:[e.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-gray-700",children:s.map(u=>e.jsx(yt,{record:u,median:n,isEditMode:o,isSelected:a.has(u.id),onSelect:m},u.id))})}),o&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700 flex justify-center",children:e.jsxs("button",{onClick:x,disabled:a.size===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-semibold transition-colors ${a.size===0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsxs("span",{children:["Delete Selected (",a.size,")"]})]})})]})},bt=({onAddLocation:s,onClearWorkLocations:n,workLocationCount:t,onClearAllData:o,autoStopRadius:r,onAutoStopRadiusChange:a,autoStopEnabled:i,onAutoStopEnabledChange:l,autoRecordWorkLocation:m,onAutoRecordWorkLocationChange:x,includeWeekends:f,onIncludeWeekendsChange:u})=>{const[j,h]=N.useState(!1),[R,B]=N.useState(""),[Q,v]=N.useState(!1),E=()=>{h(!0),B("Getting your current location..."),navigator.geolocation.getCurrentPosition(k=>{const{latitude:O,longitude:Y}=k.coords;s({latitude:O,longitude:Y}),h(!1),B(`Location recorded! Total recordings: ${t+1}. The average is used as your work location.`)},k=>{h(!1),B(`Error: ${k.message}`)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},H=()=>{n(),B("")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(W,{title:"AutoStop Feature",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Enable or disable automatic timer stopping when you arrive at your work location."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Enable AutoStop"}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:k=>l(k.target.checked),className:"sr-only",id:"autoStopToggle"}),e.jsx("label",{htmlFor:"autoStopToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${i?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${i?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When disabled, you will need to manually stop the timer when you arrive at work."})]})}),e.jsx(W,{title:"Work Location",children:e.jsxs("div",{className:`space-y-4 ${i?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"To enable automatic arrival detection, please record your work location. You can record it multiple times for better accuracy. The application will use the average of all recorded points."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Auto-record Work Location"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Record GPS position when stopping timer"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:k=>x(k.target.checked),className:"sr-only",id:"autoRecordWorkLocationToggle",disabled:!i}),e.jsx("label",{htmlFor:"autoRecordWorkLocationToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${m&&i?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${m&&i?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, your GPS location will be automatically recorded as a work location each time you stop the commute timer."}),e.jsxs("p",{className:"text-gray-300 font-semibold",children:["Current Recordings: ",e.jsx("span",{className:"text-cyan-400",children:t})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(xe,{onClick:E,disabled:j||!i,children:j?"Recording...":"Record Current Location"}),e.jsx(xe,{onClick:H,disabled:t===0||!i,variant:"danger",children:"Clear Work Locations"})]}),R&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:R})]})}),e.jsx(W,{title:"Auto-Stop Settings",children:e.jsxs("div",{className:`space-y-4 ${i?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"Set the radius around your work location where the timer will automatically stop when you arrive."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"autoStopRadius",className:"text-gray-300 font-semibold",children:"Auto-Stop Radius"}),e.jsxs("span",{className:"text-cyan-400 font-bold",children:[r,"m"]})]}),e.jsx("input",{id:"autoStopRadius",type:"range",min:"10",max:"250",step:"10",value:r,onChange:k=>a(Number(k.target.value)),disabled:!i,className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"10m"}),e.jsx("span",{children:"250m"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Smaller radius = more precise arrival detection but may require you to be very close to your work location. Larger radius = more forgiving but may stop the timer before you actually arrive."})]})]})}),e.jsx(W,{title:"Statistics Display",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Configure how data is displayed in the Statistics view."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Include Weekends in Day-of-Week Chart"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show Saturday and Sunday in weekly pattern analysis"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:k=>u(k.target.checked),className:"sr-only",id:"includeWeekendsToggle"}),e.jsx("label",{htmlFor:"includeWeekendsToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${f?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${f?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, the day-of-week chart will include weekend data. Most users only commute on weekdays."})]})}),e.jsx(W,{title:"Data Management",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Permanently delete all your commute records and saved work locations. This action cannot be undone."}),e.jsx(xe,{onClick:o,variant:"danger",children:"Clear All Data"})]})}),e.jsx(W,{title:"About",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("span",{className:"text-6xl",children:"ℹ️"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-2",children:"Commute Tracker"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"A Progressive Web App for tracking and analyzing your daily commute times"})]}),e.jsx("button",{onClick:()=>v(!Q),className:"w-full flex items-center justify-between bg-gray-800 p-3 rounded-lg hover:bg-gray-750 transition-colors",children:e.jsx("span",{className:"text-gray-300 font-semibold",children:Q?"▼ Hide Details":"▶ Show Details"})}),Q&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Technologies & Libraries"}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"React"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"19.2.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TypeScript"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"5.2.2"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Vite"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"7.1.12"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TailwindCSS"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.4.18"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Recharts"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.3.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"jsPDF"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.0.3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"PWA (vite-plugin-pwa)"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"1.1.0"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Features"}),e.jsx("div",{className:"bg-gray-800 p-3 rounded-lg",children:e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("li",{children:"• Real-time GPS-based commute tracking"}),e.jsx("li",{children:"• Automatic arrival detection"}),e.jsx("li",{children:"• Statistical analysis (Shapiro-Wilk, Mann-Kendall, Runs Test)"}),e.jsx("li",{children:"• Interactive charts and histograms"}),e.jsx("li",{children:"• CSV and PDF export capabilities"}),e.jsx("li",{children:"• Offline support via PWA"}),e.jsx("li",{children:"• Local storage (no server required)"})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"License"}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:e.jsx("span",{className:"font-semibold text-cyan-400",children:"MIT License"})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("p",{children:'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:'})," ",e.jsx("p",{children:"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software."})," ",e.jsx("p",{children:'THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.'})]})]})]}),e.jsxs("div",{className:"text-center pt-4 border-t border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"© 2025 Johan Persson"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All rights reserved"})]})]})]})})]})};function le(s,n){const[t,o]=N.useState(()=>{try{const r=window.localStorage.getItem(s);return r?JSON.parse(r):n}catch(r){return console.error(r),n}});return N.useEffect(()=>{try{const r=typeof t=="function"?t(t):t;window.localStorage.setItem(s,JSON.stringify(r))}catch(r){console.error(r)}},[s,t]),[t,o]}const Nt=()=>{const[s,n]=N.useState("main"),[t,o]=le("commuteRecords",[]),[r,a]=le("workLocations",[]),[i,l]=le("autoStopRadius",50),[m,x]=le("autoStopEnabled",!0),[f,u]=le("autoRecordWorkLocation",!1),[j,h]=le("includeWeekends",!1),R="0.7.0",B=N.useMemo(()=>{if(r.length===0)return null;const C=r.reduce((G,V)=>(G.latitude+=V.latitude,G.longitude+=V.longitude,G),{latitude:0,longitude:0});return{latitude:C.latitude/r.length,longitude:C.longitude/r.length}},[r]),Q=N.useMemo(()=>{if(t.length<1)return null;const C=t.map(G=>G.duration);return{min:nt(C),max:at(C),mean:ge(C),median:Ce(C),stdDev:Re(C)}},[t]),v=C=>{const G={id:Date.now(),date:new Date().toISOString(),duration:C};o(V=>[...V,G].sort((pe,oe)=>new Date(oe.date).getTime()-new Date(pe.date).getTime()))},E=C=>{a(G=>[...G,C])},H=()=>{window.confirm("Are you sure you want to clear all work location recordings? This will disable automatic arrival detection until you record new locations.")&&(a([]),alert("All work location recordings have been cleared."))},k=C=>{o(G=>G.filter(V=>!C.includes(V.id)))},O=()=>{window.confirm("Are you sure you want to delete all commute records and work locations? This action cannot be undone.")&&(o([]),a([]),alert("All data has been cleared."))},Y=()=>{switch(s){case"stats":return e.jsx(gt,{records:t,stats:Q,includeWeekends:j});case"history":return e.jsx(jt,{records:t,median:Q?.median,onDeleteRecords:k});case"settings":return e.jsx(bt,{onAddLocation:E,onClearWorkLocations:H,workLocationCount:r.length,onClearAllData:O,autoStopRadius:i,onAutoStopRadiusChange:l,autoStopEnabled:m,onAutoStopEnabledChange:x,autoRecordWorkLocation:f,onAutoRecordWorkLocationChange:u,includeWeekends:j,onIncludeWeekendsChange:h});case"main":default:return e.jsx(et,{onSaveCommute:v,workLocation:m?B:null,autoStopRadius:i,autoRecordWorkLocation:f,onAddWorkLocation:E})}};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 font-sans flex flex-col",children:[e.jsx(_e,{activeView:s,setView:n}),e.jsx("main",{className:"flex-grow container mx-auto p-4 md:p-6",children:Y()}),e.jsx("footer",{className:"text-center p-4 text-xs text-gray-500",children:e.jsxs("p",{children:["Commute Tracker v",R,", © Johan Persson 2025"]})})]})};function vt(s={}){const{immediate:n=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:r,onRegisteredSW:a,onRegisterError:i}=s;let l,m;const x=async(u=!0)=>{await m};async function f(){if("serviceWorker"in navigator){if(l=await qe(async()=>{const{Workbox:u}=await import("./vendor-CXwva4lO.js").then(j=>j.af);return{Workbox:u}},[]).then(({Workbox:u})=>new u("/commute/sw.js",{scope:"/commute/",type:"classic"})).catch(u=>{i?.(u)}),!l)return;l.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),l.addEventListener("installed",u=>{u.isUpdate||o?.()}),l.register({immediate:n}).then(u=>{a?a("/commute/sw.js",u):r?.(u)}).catch(u=>{i?.(u)})}}return m=f(),x}vt({immediate:!0,onRegistered(s){console.log("SW registered: ",s)},onRegisterError(s){console.log("SW registration error",s)}});const Pe=document.getElementById("root");if(!Pe)throw new Error("Could not find root element to mount to");const wt=ze.createRoot(Pe);wt.render(e.jsx(He.StrictMode,{children:e.jsx(Nt,{})}));
