import{a9 as e,r as N,aa as Pe,ab as ze}from"./vendor-CXwva4lO.js";import{R as we,B as Se,C as Ce,X as De,Y as Te,T as Me,a as ke,b as Fe}from"./recharts-DBSh6Zai.js";import{E as Ye,a as de,_ as He}from"./jspdf-TjYnE4-S.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();const ge=({label:s,viewName:r,activeView:t,setView:o,Icon:a})=>{const n=t===r;return e.jsxs("button",{onClick:()=>o(r),className:`flex flex-col items-center justify-center w-full py-2 px-1 text-xs sm:text-sm transition-colors duration-200 ${n?"text-cyan-400":"text-gray-400 hover:text-cyan-300"}`,children:[e.jsx(a,{className:"w-6 h-6 mb-1"}),e.jsx("span",{children:s})]})},Be=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Oe=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})}),Ve=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"})}),qe=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75v.01M12 17.25v.01"})]}),Ge=({activeView:s,setView:r})=>e.jsxs("header",{className:"bg-gray-800 shadow-lg sticky top-0 z-10",children:[e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-between items-center py-2",children:e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white tracking-wider",children:"Commute Tracker"})})}),e.jsx("nav",{className:"bg-gray-800/50 border-t border-gray-700",children:e.jsxs("div",{className:"container mx-auto flex justify-around",children:[e.jsx(ge,{label:"Timer",viewName:"main",activeView:s,setView:r,Icon:Be}),e.jsx(ge,{label:"Stats",viewName:"stats",activeView:s,setView:r,Icon:Oe}),e.jsx(ge,{label:"History",viewName:"history",activeView:s,setView:r,Icon:Ve}),e.jsx(ge,{label:"Settings",viewName:"settings",activeView:s,setView:r,Icon:qe})]})})]}),Ke=(s,r)=>{const o=s.latitude*Math.PI/180,a=r.latitude*Math.PI/180,n=(r.latitude-s.latitude)*Math.PI/180,l=(r.longitude-s.longitude)*Math.PI/180,i=Math.sin(n/2)*Math.sin(n/2)+Math.cos(o)*Math.cos(a)*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},_e=({workLocation:s,onStop:r,autoStopRadius:t=50,autoRecordWorkLocation:o=!1,onAddWorkLocation:a})=>{const[n,l]=N.useState(!1),[i,d]=N.useState(0),[x,p]=N.useState('Press "Leaving" to start your commute.'),[m,j]=N.useState(null),u=N.useRef(null),f=N.useRef(null);N.useEffect(()=>{const M=localStorage.getItem("commuteStartTime");if(M){const W=parseInt(M,10);l(!0),d((Date.now()-W)/1e3),p("Commute resumed...")}},[]),N.useEffect(()=>(n?u.current=window.setInterval(()=>{const M=localStorage.getItem("commuteStartTime");M&&d((Date.now()-parseInt(M,10))/1e3)},1e3):u.current&&(clearInterval(u.current),u.current=null),()=>{u.current&&clearInterval(u.current)}),[n]);const z=N.useCallback(M=>{if(!n)return;l(!1),u.current&&(clearInterval(u.current),u.current=null),f.current&&(navigator.geolocation.clearWatch(f.current),f.current=null);const W=localStorage.getItem("commuteStartTime"),V=W?parseInt(W,10):Date.now(),S=(Date.now()-V)/1e3;localStorage.removeItem("commuteStartTime"),o&&a?navigator.geolocation.getCurrentPosition(C=>{const{latitude:F,longitude:I}=C.coords;a({latitude:F,longitude:I}),p(M||`Commute recorded! Duration: ${Math.round(S)}s. Work location auto-recorded.`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)},C=>{console.error("Failed to record work location automatically:",C),p(M||`Commute recorded! Duration: ${Math.round(S)}s. Failed to auto-record location.`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(p(M||`Commute recorded! Duration: ${Math.round(S)}s`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)),r(S),d(0),j(null)},[n,r,o,a]);return N.useEffect(()=>(n&&s&&(p("GPS tracking active..."),f.current=navigator.geolocation.watchPosition(M=>{const W={latitude:M.coords.latitude,longitude:M.coords.longitude},V=Ke(W,s);j(V),p(`Tracking... ${V.toFixed(0)}m to destination.`),V<t&&z("Arrived at work location automatically.")},M=>{console.error("Geolocation error:",M),p("GPS error. Tracking may be unreliable.")},{enableHighAccuracy:!0,maximumAge:0})),()=>{f.current&&navigator.geolocation.clearWatch(f.current)}),[n,s,t,z]),{isRunning:n,elapsedTime:i,startTimer:()=>{if(n)return;const M=Date.now();localStorage.setItem("commuteStartTime",M.toString()),l(!0),d(0),p("Commute started. Have a safe trip!")},stopTimer:z,statusMessage:x,distance:m}},$=({title:s,children:r,headerAction:t})=>e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-xl shadow-lg w-full max-w-2xl mx-auto",children:[s&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s}),t&&e.jsx("div",{className:"flex items-center",children:t})]}),e.jsx("div",{className:"p-4 md:p-6",children:r})]}),Ue=s=>{const r=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(r).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},Xe=({onSaveCommute:s,workLocation:r,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:a})=>{const{isRunning:n,elapsedTime:l,startTimer:i,stopTimer:d,statusMessage:x,distance:p}=_e({workLocation:r,onStop:s,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:a}),m=()=>{i()},j=()=>{d()};return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-6",children:[e.jsx($,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-400 mb-2",children:"Commute Duration"}),e.jsx("h2",{className:"text-5xl sm:text-7xl md:text-8xl font-mono font-bold tracking-widest text-cyan-400",children:Ue(l)})]})}),e.jsx("div",{className:"w-full max-w-sm flex flex-col gap-4",children:n?e.jsx("button",{onClick:j,className:"w-full bg-red-500 hover:bg-red-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Arrive"}):e.jsx("button",{onClick:m,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Leaving"})}),e.jsxs("div",{className:"text-center text-gray-400 mt-4 h-10",children:[e.jsx("p",{children:x}),p!==null&&e.jsxs("p",{children:["Distance to work: ",p.toFixed(0),"m"]})]})]})},Ze=({records:s,binSizeMinutes:r})=>{const t=N.useMemo(()=>{if(s.length===0)return[];const a=s.map(x=>x.duration/60),n=Math.max(...a),l={};for(const x of a){const p=Math.floor(x/r)*r,m=p+r,j=`${p}-${m}`;l[j]=(l[j]||0)+1}Object.keys(l).sort((x,p)=>parseInt(x.split("-")[0])-parseInt(p.split("-")[0]));const i=Math.floor(n/r)*r,d=[];for(let x=0;x<=i;x+=r){const p=x+r,m=`${x}-${p}`;d.push({name:m,count:l[m]||0})}return d},[s,r]),o=N.useMemo(()=>{if(t.length===0)return;const a=Math.max(...t.map(n=>n.count));if(a===0)return[0];for(const n of[2,4,6,8,10,20,40,60,80,100]){const l=Math.ceil(a/n);if(l>=3&&l<=6){const i=[];for(let d=0;d<=l;d++)i.push(d*n);return i}}for(const n of[5,10,15,25,50]){const l=Math.ceil(a/n);if(l>=3&&l<=6){const i=[];for(let d=0;d<=l;d++)i.push(d*n);return i}}},[t]);return e.jsx(we,{width:"100%",height:"100%",children:e.jsxs(Se,{data:t,margin:{top:5,right:20,left:-10,bottom:5},children:[e.jsx(Ce,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(De,{dataKey:"name",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(Te,{allowDecimals:!1,stroke:"#A0AEC0",tick:{fontSize:12},ticks:o,domain:o?[0,o[o.length-1]]:[0,"auto"]}),e.jsx(Me,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#63B3ED"},formatter:a=>[`${a} trips`,"Count"],labelFormatter:a=>`Time: ${a} min`}),e.jsx(ke,{dataKey:"count",name:"Trips",children:t.map((a,n)=>e.jsx(Fe,{fill:"#2DD4BF"},`cell-${n}`))})]})})},Je=({records:s})=>{const r=N.useMemo(()=>{if(s.length===0)return[];const t={};s.forEach(a=>{const n=new Date(a.date).getHours();t[n]||(t[n]={totalDuration:0,count:0}),t[n].totalDuration+=a.duration,t[n].count++});const o=[];for(let a=0;a<24;a++){const n=t[a];n&&o.push({hour:`${String(a).padStart(2,"0")}:00`,averageDuration:n.totalDuration/n.count/60,count:n.count})}return o},[s]);return r.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No commute data to display."}):e.jsx(we,{width:"100%",height:"100%",children:e.jsxs(Se,{data:r,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(Ce,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(De,{dataKey:"hour",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(Te,{dataKey:"averageDuration",unit:"m",stroke:"#A0AEC0",tick:{fontSize:12},width:40}),e.jsx(Me,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#81E6D9"},formatter:(t,o,a)=>o==="averageDuration"?[`${t.toFixed(1)} min (average of ${a.payload.count} trips)`,"Duration"]:[t,o],labelFormatter:t=>`Time: ${t}`}),e.jsx(ke,{dataKey:"averageDuration",name:"averageDuration",children:r.map((t,o)=>e.jsx(Fe,{fill:"#81E6D9"},`cell-${o}`))})]})})},Qe=s=>s.length===0?0:Math.min(...s),et=s=>s.length===0?0:Math.max(...s),fe=s=>s.length===0?0:s.reduce((t,o)=>t+o,0)/s.length,Re=s=>{if(s.length===0)return 0;const r=[...s].sort((o,a)=>o-a),t=Math.floor(r.length/2);return r.length%2===0?(r[t-1]+r[t])/2:r[t]},tt=s=>{if(s.length<2)return 0;const r=fe(s),t=s.reduce((o,a)=>o+Math.pow(a-r,2),0)/(s.length-1);return Math.sqrt(t)},be=(s,r)=>{if(s.length===0)return 0;const t=[...s].sort((i,d)=>i-d),o=r/100*(t.length-1);if(Number.isInteger(o))return t[o];const a=Math.floor(o),n=Math.ceil(o),l=o-a;return t[a]*(1-l)+t[n]*l},Ne=(s,r)=>{if(s.length===0)return 0;const t=[...s].sort((a,n)=>a-n),o=Math.ceil(r/100*t.length)-1;return t[Math.max(0,o)]},Le=(s,r=90)=>{if(s.length<5)return null;const t=(100-r)/2,o=t,a=100-t;return{low:be(s,o),high:be(s,a)}},Ae=(s,r=90)=>{if(s.length<5)return null;const t=(100-r)/2,o=t,a=100-t;return{low:Ne(s,o),high:Ne(s,a)}},st=s=>{const r=s.length;if(r<3)return null;const t=[...s].sort((u,f)=>u-f),o=fe(t),a=t.reduce((u,f)=>u+Math.pow(f-o,2),0);if(a===0)return{W:1,pValue:1,isNormal:!0};const n=new Array(r);for(let u=0;u<r;u++){const f=(u+1-.375)/(r+.25);n[u]=nt(f)}const l=n.reduce((u,f)=>u+f*f,0),i=1/Math.sqrt(l);let d=0;for(let u=0;u<r;u++)d+=n[u]*t[u];d=d*d*i*i;const x=d/a,p=Math.max(0,Math.min(1,x));if(Math.abs(x-p)>.01)return console.error(`Shapiro-Wilk W statistic out of range: ${x}`),null;const m=rt(p,r),j=m>.05;return{W:p,pValue:m,isNormal:j}};function nt(s){const r=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],t=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],o=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],a=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416],n=.02425,l=1-n;if(s<n){const i=Math.sqrt(-2*Math.log(s));return(((((o[0]*i+o[1])*i+o[2])*i+o[3])*i+o[4])*i+o[5])/((((a[0]*i+a[1])*i+a[2])*i+a[3])*i+1)}else if(s<=l){const i=s-.5,d=i*i;return(((((r[0]*d+r[1])*d+r[2])*d+r[3])*d+r[4])*d+r[5])*i/(((((t[0]*d+t[1])*d+t[2])*d+t[3])*d+t[4])*d+1)}else{const i=Math.sqrt(-2*Math.log(1-s));return-(((((o[0]*i+o[1])*i+o[2])*i+o[3])*i+o[4])*i+o[5])/((((a[0]*i+a[1])*i+a[2])*i+a[3])*i+1)}}function rt(s,r){if(s<=0||s>1)return 0;if(s===1)return 1;const t={20:{p01:.868,p05:.905,p10:.918},25:{p01:.888,p05:.918,p10:.928},30:{p01:.9,p05:.927,p10:.935},35:{p01:.91,p05:.934,p10:.941},40:{p01:.917,p05:.94,p10:.945},50:{p01:.927,p05:.947,p10:.951},60:{p01:.935,p05:.952,p10:.956},70:{p01:.941,p05:.956,p10:.959},80:{p01:.945,p05:.959,p10:.962},90:{p01:.949,p05:.962,p10:.964},100:{p01:.952,p05:.964,p10:.966},110:{p01:.954,p05:.966,p10:.967},120:{p01:.956,p05:.967,p10:.969},130:{p01:.958,p05:.968,p10:.97},140:{p01:.959,p05:.969,p10:.971},150:{p01:.96,p05:.97,p10:.972},160:{p01:.961,p05:.971,p10:.973},170:{p01:.962,p05:.972,p10:.974},180:{p01:.963,p05:.973,p10:.974},190:{p01:.964,p05:.973,p10:.975},200:{p01:.965,p05:.974,p10:.975},210:{p01:.965,p05:.974,p10:.976},220:{p01:.966,p05:.975,p10:.976},230:{p01:.966,p05:.975,p10:.977},240:{p01:.967,p05:.976,p10:.977},250:{p01:.967,p05:.976,p10:.978}};let o=20,a=Math.abs(r-20);for(const l of Object.keys(t).map(Number)){const i=Math.abs(r-l);i<a&&(a=i,o=l)}const n=t[o];if(s>=n.p10){const l=1-n.p10;return .1+(s-n.p10)/l*.9}else if(s>=n.p05){const l=n.p10-n.p05;return .05+(s-n.p05)/l*.05}else if(s>=n.p01){const l=n.p05-n.p01;return .01+(s-n.p01)/l*.04}else{const l=n.p01;return s/l*.01}}function Ie(s){return .5*(1+at(s/Math.sqrt(2)))}function at(s){const r=.254829592,t=-.284496736,o=1.421413741,a=-1.453152027,n=1.061405429,l=.3275911,i=s>=0?1:-1;s=Math.abs(s);const d=1/(1+l*s),x=1-((((n*d+a)*d+o)*d+t)*d+r)*d*Math.exp(-s*s);return i*x}function ot(s){const r=s.length;if(r<10)return null;let t=0;for(let p=0;p<r-1;p++)for(let m=p+1;m<r;m++){const j=s[m]-s[p];j>0?t++:j<0&&t--}const o=2*t/(r*(r-1)),a=r*(r-1)*(2*r+5)/18;let n;t>1?n=(t-1)/Math.sqrt(a):t<-1?n=(t+1)/Math.sqrt(a):n=t/Math.sqrt(a);const i=2*(1-Ie(Math.abs(n)));let d;i<.05?d=t>0?"increasing":"decreasing":d="no trend";let x;return i<.01?x="strong":i<.05?x="moderate":i<.1?x="weak":x="none",{S:t,tau:o,zScore:n,pValue:i,trend:d,significance:x}}function it(s){const r=s.length;if(r<10)return null;const t=Re(s),o=s.map(u=>u>t?1:0),a=o.filter(u=>u===1).length,n=o.filter(u=>u===0).length;if(a===0||n===0)return null;let l=1;for(let u=1;u<r;u++)o[u]!==o[u-1]&&l++;const i=2*a*n/(a+n)+1,d=2*a*n*(2*a*n-a-n)/(Math.pow(a+n,2)*(a+n-1));let x;l>i?x=(l-.5-i)/Math.sqrt(d):l<i?x=(l+.5-i)/Math.sqrt(d):x=0;const p=2*(1-Ie(Math.abs(x)));let m;p<.05?m=l<i?"clustered":"oscillating":m="random";let j;return p<.01?j="strong":p<.05?j="moderate":p<.1?j="weak":j="none",{runs:l,expectedRuns:i,zScore:x,pValue:p,pattern:m,significance:j}}const ee=s=>{if(isNaN(s)||s<0)return"N/A";const r=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(r).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},lt=s=>{const r=["ID","Date","Time","Duration (s)"],t=s.map(l=>{const i=new Date(l.date),d=i.toLocaleDateString(),x=i.toLocaleTimeString("en-GB",{hour12:!1});return[l.id,d,x,l.duration.toFixed(2)]});let o="data:text/csv;charset=utf-8,"+r.join(",")+`
`+t.map(l=>l.join(",")).join(`
`);const a=encodeURI(o),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download","commute_records.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n)},ct=(s,r)=>{const t=new Ye,o=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Time Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const a=`Report Date: ${o}`,n=t.getTextWidth(a);t.text(a,196-n,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Statistics Summary",14,35);const l=s.map(c=>c.duration),i=s.length>=5?Le(l,90):null,d=s.length>=5?Ae(l,90):null,x=[["Total Trips",s.length.toString()],["Min Duration",ee(r.min)],["Max Duration",ee(r.max)],["Mean (Average)",ee(r.mean)],["Median",ee(r.median)],["Standard Deviation",ee(r.stdDev)]];i&&d?(x.push(["",""]),x.push(["90% Confidence Interval (Interpolated)",""]),x.push(["  • Low (5th percentile)",ee(i.low)]),x.push(["  • High (95th percentile)",ee(i.high)]),x.push(["90% Confidence Interval (Nearest Rank)",""]),x.push(["  • Low (5th percentile)",ee(d.low)]),x.push(["  • High (95th percentile)",ee(d.high)])):(x.push(["",""]),x.push(["90% Confidence Intervals","Requires 5+ records"])),t.setFont("helvetica","normal"),de(t,{startY:40,head:[["Metric","Value"]],body:x,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const m=(()=>{const c=s.reduce((v,y)=>v+y.duration,0),h=new Date,w=h.getFullYear(),D=h.getMonth(),T=h.toISOString().split("T")[0],L=v=>{const y=new Date(v),B=y.getDay(),te=y.getDate()-B+(B===0?-6:1);return y.setDate(te),y.toISOString().split("T")[0]},R=L(h),P=s.filter(v=>new Date(v.date).toISOString().split("T")[0]===T).reduce((v,y)=>v+y.duration,0),Q=s.filter(v=>L(new Date(v.date))===R).reduce((v,y)=>v+y.duration,0),ne=s.filter(v=>{const y=new Date(v.date);return y.getFullYear()===w&&y.getMonth()===D}).reduce((v,y)=>v+y.duration,0),_=s.filter(v=>new Date(v.date).getFullYear()===w).reduce((v,y)=>v+y.duration,0);return{dayTotal:P,weekTotal:Q,monthTotal:ne,yearTotal:_,totalTime:c}})(),j=c=>{const h=Math.floor(c/3600),w=Math.floor(c%3600/60);return h===0?`${w} minutes`:`${h} hours ${w} minutes`};let u=t.lastAutoTable.finalY+15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Total Commute Time",14,u),t.setFont("helvetica","normal"),de(t,{startY:u+5,head:[["Period","Total Time"]],body:[["Today",j(m.dayTotal)],["This Week",j(m.weekTotal)],["This Month",j(m.monthTotal)],["This Year",j(m.yearTotal)],["All Time",j(m.totalTime)]],theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Charts & Analysis",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const f=`Report Date: ${o}`,z=t.getTextWidth(f);t.text(f,196-z,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Commute Duration Distribution",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows how your commute times are distributed across different duration ranges.",14,45);const Y=5,M={};s.forEach(c=>{const h=Math.floor(c.duration/60),w=Math.floor(h/Y)*Y,D=w+Y,T=`${w}-${D}`;M[T]=(M[T]||0)+1});const W=Object.entries(M).sort(([c],[h])=>parseInt(c.split("-")[0])-parseInt(h.split("-")[0])),V=210,S=153,C=(V-S)/2,F=60,I=80,ce=Math.max(...W.map(([,c])=>c)),U=S/W.length,oe=(c=>{if(c===0)return{values:[0,0,0,0,0],numDivisions:4};const h=[2,4,6,8,10,20,40,60,80,100,200];for(const v of h){const y=Math.ceil(c/v);if(y>=3&&y<=6){const B=[],te=y*v;for(let H=0;H<=y;H++)B.push(te*H/y);return{values:B,numDivisions:y}}}const w=[5,15,25,50,150,250];for(const v of w){const y=Math.ceil(c/v);if(y>=3&&y<=6){const B=[],te=y*v;for(let H=0;H<=y;H++)B.push(te*H/y);return{values:B,numDivisions:y}}}const D=4,T=c/D,L=Math.pow(10,Math.floor(Math.log10(T))),R=T/L;let P;R<=1?P=1:R<=2?P=2:R<=5?P=5:P=10;const Q=P*L,ne=Math.ceil(c/Q)*Q,_=[];for(let v=0;v<=D;v++)_.push(ne*v/D);return{values:_,numDivisions:D}})(ce),K=oe.values,k=oe.numDivisions;t.setFillColor(249,250,251),t.rect(C,F,S,I,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(C,F,S,I,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let c=1;c<k;c++){const h=F+I-I*c/k;t.line(C,h,C+S,h)}W.forEach(([c,h],w)=>{const D=K[K.length-1],T=D>0?h/D*I:0,L=C+w*U+2,R=F+I-T;t.setFillColor(200,200,200),t.rect(L+1,R+1,U-4,T,"F"),t.setFillColor(25,51,102),t.rect(L,R,U-4,T,"F"),t.setDrawColor(15,35,70),t.setLineWidth(.5),t.rect(L,R,U-4,T,"S"),T>15?(t.setFontSize(8),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(h.toString(),L+(U-4)/2,R+T/2,{align:"center"})):T>5&&(t.setFontSize(7),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(h.toString(),L+(U-4)/2,R-2,{align:"center"}))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let c=0;c<=k;c++){const h=K[c],w=F+I-I*c/k,D=h%1===0?h.toString():h.toFixed(1);t.text(D,C-5,w+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),W.forEach(([c],h)=>{const w=C+h*U+U/2,D=F+I+8;t.text(c.replace("-","–")+"m",w,D,{align:"center",angle:45})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",C-10,F+I/2,{align:"center",angle:90}),t.text("Duration Range (minutes)",C+S/2,F+I+20,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Duration Histogram",C+S/2,F-5,{align:"center"});const A=W.map(([c,h])=>[c+" min",h.toString()]);u=F+I+35,de(t,{startY:u,head:[["Duration Range","Number of Commutes"]],body:A,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),u=t.lastAutoTable.finalY+15,u>200&&(t.addPage(),u=20),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Time of Day Breakdown",14,u),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows when you typically commute throughout the day.",14,u+10);const xe=["Early Morning (5-9)","Morning (9-12)","Afternoon (12-17)","Evening (17-21)","Night (21-5)"],g=[[216,191,140],[147,171,129],[108,141,162],[133,119,144],[89,107,125]],b={};xe.forEach(c=>{b[c]=0}),s.forEach(c=>{const h=new Date(c.date).getHours();let w="";h>=5&&h<9?w="Early Morning (5-9)":h>=9&&h<12?w="Morning (9-12)":h>=12&&h<17?w="Afternoon (12-17)":h>=17&&h<21?w="Evening (17-21)":w="Night (21-5)",b[w]=(b[w]||0)+1});const E=xe.map(c=>[c,b[c]]),O=Math.max(...E.map(([,c])=>c)),X=(c=>{if(c===0)return{values:[0,0,0,0,0],numDivisions:4};const h=[2,4,6,8,10,20,40,60,80,100,200];for(const v of h){const y=Math.ceil(c/v);if(y>=3&&y<=6){const B=[],te=y*v;for(let H=0;H<=y;H++)B.push(te*H/y);return{values:B,numDivisions:y}}}const w=[5,15,25,50,150,250];for(const v of w){const y=Math.ceil(c/v);if(y>=3&&y<=6){const B=[],te=y*v;for(let H=0;H<=y;H++)B.push(te*H/y);return{values:B,numDivisions:y}}}const D=4,T=c/D,L=Math.pow(10,Math.floor(Math.log10(T))),R=T/L;let P;R<=1?P=1:R<=2?P=2:R<=5?P=5:P=10;const Q=P*L,ne=Math.ceil(c/Q)*Q,_=[];for(let v=0;v<=D;v++)_.push(ne*v/D);return{values:_,numDivisions:D}})(O),ie=X.values,le=X.numDivisions,ae=153,Z=(V-ae)/2,J=u+25,G=70,se=ae/E.length;t.setFillColor(249,250,251),t.rect(Z,J,ae,G,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(Z,J,ae,G,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let c=1;c<le;c++){const h=J+G-G*c/le;t.line(Z,h,Z+ae,h)}E.forEach(([c,h],w)=>{const D=ie[ie.length-1],T=D>0?h/D*G:0,L=Z+w*se+4,R=J+G-T;t.setFillColor(200,200,200),t.rect(L+1,R+1,se-8,T,"F");const[P,Q,ne]=g[w];t.setFillColor(P,Q,ne),t.rect(L,R,se-8,T,"F"),t.setDrawColor(P*.7,Q*.7,ne*.7),t.setLineWidth(.5),t.rect(L,R,se-8,T,"S");const _=h;_>0&&(T>15?(t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(_.toString(),L+(se-8)/2,R+T/2,{align:"center"})):(t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(_.toString(),L+(se-8)/2,R-2,{align:"center"})))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let c=0;c<=le;c++){const h=ie[c],w=J+G-G*c/le,D=h%1===0?h.toString():h.toFixed(1);t.text(D,Z-5,w+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),E.forEach(([c],h)=>{const w=Z+h*se+se/2,D=J+G+8,T=c.split(" ")[0]+`
`+c.match(/\(([^)]+)\)/)?.[1];t.text(T,w,D,{align:"center"})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",Z-10,J+G/2,{align:"center",angle:90}),t.text("Time of Day",Z+ae/2,J+G+22,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Time Distribution by Period",Z+ae/2,J-5,{align:"center"});const ye=E.filter(([,c])=>c>0).sort(([,c],[,h])=>h-c).map(([c,h])=>[c,h.toString()]);u=J+G+35,ye.length>0&&de(t,{startY:u,head:[["Time Period","Number of Commutes"]],body:ye,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Recent Commute Records",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const je=`Report Date: ${o}`,Ee=t.getTextWidth(je);t.text(je,196-Ee,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Latest Commute Records",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows your most recent commute records in chronological order.",14,45);const We=s.slice(0,25);u=55,de(t,{startY:u,head:[["Date","Time","Duration"]],body:We.map(c=>{const h=new Date(c.date);return[h.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),h.toLocaleTimeString("en-GB",{hour12:!1}),ee(c.duration)]}),theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const ve=t.internal.getNumberOfPages();for(let c=1;c<=ve;c++)t.setPage(c),t.setFontSize(10),t.setFont("helvetica","italic"),t.text(`Page ${c} of ${ve}`,t.internal.pageSize.getWidth()/2,t.internal.pageSize.getHeight()-10,{align:"center"});t.save(`commute_report_${new Date().toISOString().split("T")[0]}.pdf`)},pe=({children:s,variant:r="primary",...t})=>{const o="font-bold py-2 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md",a={primary:"bg-cyan-500 hover:bg-cyan-600 text-white",secondary:"bg-gray-600 hover:bg-gray-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white"};return e.jsx("button",{className:`${o} ${a[r]}`,...t,children:s})},re=s=>{if(isNaN(s)||s<0)return"N/A";const r=Math.floor(s/60),t=Math.floor(s%60);return`${r}m ${t}s`},dt=({records:s,stats:r})=>{const[t,o]=N.useState(5),[a,n]=N.useState(""),[l,i]=N.useState(""),[d,x]=N.useState(""),[p,m]=N.useState(""),j=g=>g.toISOString().split("T")[0],u=g=>{const b=new Date(g),E=b.getDay(),O=b.getDate()-E+(E===0?-6:1);return new Date(b.setDate(O))},f=N.useMemo(()=>{if(s.length===0)return{days:[],weeks:[],months:[],years:[]};const g=new Set,b=new Set,E=new Set,O=new Set;return s.forEach(q=>{const X=new Date(q.date);g.add(j(X));const ie=u(X);b.add(j(ie));const le=`${X.getFullYear()}-${String(X.getMonth()+1).padStart(2,"0")}`;E.add(le),O.add(X.getFullYear().toString())}),{days:Array.from(g).sort().reverse(),weeks:Array.from(b).sort().reverse(),months:Array.from(E).sort().reverse(),years:Array.from(O).sort().reverse()}},[s]),z=(g,b)=>g==="total"?s.reduce((O,q)=>O+q.duration,0):s.filter(O=>{const q=new Date(O.date);switch(g){case"day":return b?j(q)===b:!1;case"week":if(!b)return!1;const X=u(q);return j(X)===b;case"month":return b?`${q.getFullYear()}-${String(q.getMonth()+1).padStart(2,"0")}`===b:!1;case"year":return b?q.getFullYear().toString()===b:!1;default:return!1}}).reduce((O,q)=>O+q.duration,0),Y=g=>{if(isNaN(g)||g<0)return"N/A";const b=Math.floor(g/3600),E=Math.floor(g%3600/60);return b===0?`${E}m`:`${b}h ${E}m`},M=g=>{const[b,E]=g.split("-");return new Date(parseInt(b),parseInt(E)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})},W=g=>new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),V=a?z("day",a):0,S=l?z("week",l):0,C=d?z("month",d):0,F=p?z("year",p):0,I=z("total");if(N.useMemo(()=>{f.days.length>0&&!a&&n(f.days[0]),f.weeks.length>0&&!l&&i(f.weeks[0]),f.months.length>0&&!d&&x(f.months[0]),f.years.length>0&&!p&&m(f.years[0])},[f,a,l,d,p]),!r)return e.jsx($,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Not Enough Data"}),e.jsx("p",{className:"text-gray-400",children:"Complete at least one commute to see your stats."})]})});const ce=()=>{lt(s)},U=()=>{r&&ct(s,r)},he=N.useMemo(()=>{if(s.length<5)return null;const g=s.map(b=>b.duration);return Le(g,90)},[s]),oe=N.useMemo(()=>{if(s.length<5)return null;const g=s.map(b=>b.duration);return Ae(g,90)},[s]),K=N.useMemo(()=>{if(s.length<20)return null;const g=s.map(b=>b.duration);return st(g)},[s]),k=N.useMemo(()=>{if(s.length<10)return null;const g=s.map(b=>b.duration);return ot(g)},[s]),A=N.useMemo(()=>{if(s.length<10)return null;const g=s.map(b=>b.duration);return it(g)},[s]),xe=`Statistics Summary - ${s.length} records`;return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{title:xe,children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 text-center",children:[e.jsx(me,{label:"Total Trips",value:s.length}),e.jsx(me,{label:"Min Time",value:re(r.min)}),e.jsx(me,{label:"Max Time",value:re(r.max)}),e.jsx(me,{label:"Average",value:re(r.mean)}),e.jsx(me,{label:"Median",value:re(r.median)})]})}),e.jsx($,{title:"90% Confidence Interval (Interpolated)",children:e.jsx("div",{className:"text-center",children:he?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this range, interpolated values might not exist exactly"}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(he.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(he.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx($,{title:"90% Confidence Interval (Nearest Rank)",children:e.jsx("div",{className:"text-center",children:oe?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this time range, the closest actual times are used."}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(oe.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(oe.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx($,{title:"Normality Test (Shapiro-Wilk)",children:e.jsx("div",{className:"text-center",children:K?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Tests whether commute times follow a normal (bell curve) distribution"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"W Statistic"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:K.W.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 0-1 (closer to 1 = more normal)"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"p-value"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:K.pValue.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Significance threshold: 0.05"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Distribution"}),e.jsx("p",{className:`text-2xl font-bold ${K.isNormal?"text-green-400":"text-yellow-400"}`,children:K.isNormal?"✓ Normal":"⚠ Not Normal"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:K.isNormal?"Data fits normal distribution":"Data deviates from normal"})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Interpretation:"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:K.isNormal?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Your commute times appear to follow a normal distribution (p > 0.05). This suggests that most of your commutes cluster around the average, with fewer extremely short or long commutes. Statistical methods assuming normality are appropriate for your data."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-yellow-400",children:"⚠"})," Your commute times do not follow a normal distribution (p ≤ 0.05). This could indicate consistent factors affecting your commute (traffic patterns, weather, route changes) or the presence of outliers. Consider using non-parametric statistical methods."]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • α = 0.05 significance level"]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 20 or more records for normality test"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 20 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Shapiro-Wilk test is most reliable with at least 20 samples"})]})})}),e.jsx($,{title:"Total Commute Time",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Day"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:Y(V)}),e.jsx("select",{value:a,onChange:g=>n(g.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:f.days.map(g=>e.jsx("option",{value:g,children:new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},g))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Week"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:Y(S)}),e.jsx("select",{value:l,onChange:g=>i(g.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:f.weeks.map(g=>e.jsxs("option",{value:g,children:["Week of ",W(g)]},g))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Month"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:Y(C)}),e.jsx("select",{value:d,onChange:g=>x(g.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:f.months.map(g=>e.jsx("option",{value:g,children:M(g)},g))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Year"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:Y(F)}),e.jsx("select",{value:p,onChange:g=>m(g.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:f.years.map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Total Time"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:Y(I)}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Since start"})]})]})}),e.jsxs($,{title:"Commute Duration Distribution",children:[e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(Ze,{records:s,binSizeMinutes:t})}),e.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-2",children:[e.jsx("label",{htmlFor:"binSize",className:"text-sm text-gray-400",children:"Bin Size (minutes):"}),e.jsxs("select",{id:"binSize",value:t,onChange:g=>o(Number(g.target.value)),className:"bg-gray-700 border border-gray-600 rounded-md p-1 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:1,children:"1"}),e.jsx("option",{value:2,children:"2"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"})]})]})]}),e.jsx($,{title:"Trend Analysis (Mann-Kendall Test)",children:e.jsx("div",{className:"text-center",children:k?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analyzes whether your commute times are getting longer, shorter, or staying stable over time"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Trend Direction"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[k.trend==="increasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📈"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:"Getting Longer"})]}),k.trend==="decreasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📉"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Getting Shorter"})]}),k.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"➡️"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Stable"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[k.trend==="increasing"&&"Your commute times show an upward trend",k.trend==="decreasing"&&"Your commute times show a downward trend",k.trend==="no trend"&&"No significant trend detected"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Confidence Level"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[k.significance==="strong"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"💪"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Very Strong"})]}),k.significance==="moderate"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"👍"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:"Moderate"})]}),k.significance==="weak"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤔"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:"Weak"})]}),k.significance==="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤷"}),e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Not Significant"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["p-value: ",k.pValue.toFixed(4)]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[k.trend==="increasing"&&k.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-400",children:"⚠️"})," Your commute times are trending ",e.jsx("strong",{children:"upward"}),". This could indicate increasing traffic congestion, seasonal changes, or route deterioration. Consider exploring alternative routes or adjusting your departure time."]}),k.trend==="decreasing"&&k.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Great news! Your commute times are trending ",e.jsx("strong",{children:"downward"}),". This suggests improvements in traffic flow, better route choices, or favorable seasonal changes. Keep up whatever you're doing!"]}),k.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"➡️"})," Your commute times remain ",e.jsx("strong",{children:"stable"})," over time. This consistency suggests predictable traffic patterns and reliable route conditions. Good for planning your schedule!"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • Kendall's τ = ",k.tau.toFixed(3)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for trend analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Mann-Kendall test detects monotonic trends in time series data"})]})})}),e.jsx($,{title:"Pattern Analysis (Runs Test)",children:e.jsx("div",{className:"text-center",children:A?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Detects whether your commute times follow a random pattern or show clustering/oscillation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Pattern Type"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[A.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🎲"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Random"})]}),A.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📦"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:"Clustered"})]}),A.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🌊"}),e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:"Oscillating"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[A.pattern==="random"&&"No predictable pattern detected",A.pattern==="clustered"&&"Similar times grouped together",A.pattern==="oscillating"&&"Alternating fast/slow pattern"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Runs Analysis"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:["Observed: ",e.jsx("span",{className:"font-bold text-cyan-400",children:A.runs})]}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Expected: ",e.jsx("span",{className:"font-bold text-gray-400",children:A.expectedRuns.toFixed(1)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[A.significance==="strong"&&"(Very Strong Evidence)",A.significance==="moderate"&&"(Moderate Evidence)",A.significance==="weak"&&"(Weak Evidence)",A.significance==="none"&&"(Not Statistically Significant)"]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[A.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"🎲"})," Your commute times appear ",e.jsx("strong",{children:"random"}),", with no clear pattern of clustering or alternation. This is typical when traffic conditions vary independently from day to day. Each commute is relatively unpredictable."]}),A.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-orange-400",children:"📦"})," Your commute times show ",e.jsx("strong",{children:"clustering"}),", meaning you tend to have stretches of similar commute times (several fast days followed by several slow days). This could indicate weekly patterns, weather impacts, or consistent schedule changes."]}),A.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-purple-400",children:"🌊"})," Your commute times show an ",e.jsx("strong",{children:"oscillating pattern"}),", alternating between faster and slower commutes more than expected by chance. This could suggest alternating schedules, every-other-day traffic patterns, or behavioral factors affecting your timing."]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • p-value: ",A.pValue.toFixed(4)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for pattern analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Runs Test detects non-random patterns in sequential data"})]})})}),e.jsx($,{title:"Time of Day Breakdown",children:e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(Je,{records:s})})}),e.jsx($,{title:"Export Data",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsx("p",{className:"text-gray-400 flex-grow text-center sm:text-left mb-4 sm:mb-0",children:"Export your commute history as a CSV or a PDF summary report."}),e.jsxs("div",{className:"flex gap-4 flex-shrink-0",children:[e.jsx(pe,{onClick:ce,children:"Export to CSV"}),e.jsx(pe,{onClick:U,children:"Export to PDF"})]})]})})]})},me=({label:s,value:r})=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:r})]}),mt=s=>{if(isNaN(s)||s<0)return"N/A";const r=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return[r>0?`${r}h`:"",t>0?`${t}m`:"",`${o}s`].filter(Boolean).join(" ")||"0s"},ut=(s,r)=>{if(!r||r===0)return"hsl(210, 15%, 50%)";const t=r*.5,o=r*1.5;return`hsl(${120-(Math.max(t,Math.min(o,s))-t)/(o-t)*120}, 70%, 45%)`},ht=({record:s,median:r,isEditMode:t,isSelected:o,onSelect:a})=>{const n=r?ut(s.duration,r):"hsl(210, 15%, 50%)";return e.jsxs("li",{className:"py-4 px-2 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-700/50 rounded-lg transition-colors duration-200",children:[t&&e.jsx("div",{className:"flex items-center mr-4",children:e.jsx("input",{type:"checkbox",checked:o,onChange:l=>a(s.id,l.target.checked),className:"w-4 h-4 text-red-600 bg-gray-700 border-gray-600 rounded focus:ring-red-500 focus:ring-2"})}),e.jsxs("div",{className:"flex-1 mb-2 sm:mb-0 pr-4",children:[e.jsx("p",{className:"font-semibold text-gray-200",children:mt(s.duration)}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(s.date).toLocaleString("en-GB",{hour12:!1})})]}),e.jsx("div",{className:"w-full sm:w-1/2 h-2.5 bg-gray-600 rounded-full overflow-hidden",title:"Comparison to median commute time",children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:n,width:"100%"}})})]})},xt=({records:s,median:r,onDeleteRecords:t})=>{const[o,a]=N.useState(!1),[n,l]=N.useState(new Set);if(s.length===0)return e.jsx($,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No History Yet"}),e.jsx("p",{className:"text-gray-400",children:"Your completed commutes will appear here."})]})});const i=()=>{a(!o),l(new Set)},d=(m,j)=>{const u=new Set(n);j?u.add(m):u.delete(m),l(u)},x=()=>{if(n.size===0){alert("Please select at least one record to delete.");return}const m=n.size,j=`Are you sure you want to delete ${m} selected record${m===1?"":"s"}? This action cannot be undone.`;window.confirm(j)&&(t(Array.from(n)),l(new Set),a(!1))},p=()=>{n.size===s.length?l(new Set):l(new Set(s.map(m=>m.id)))};return e.jsxs($,{title:"Commute History",headerAction:e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&n.size>0&&e.jsx("button",{onClick:p,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:n.size===s.length?"Deselect All":"Select All"}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-200 transition-colors",title:o?"Exit edit mode":"Edit records",children:o?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),children:[e.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-gray-700",children:s.map(m=>e.jsx(ht,{record:m,median:r,isEditMode:o,isSelected:n.has(m.id),onSelect:d},m.id))})}),o&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700 flex justify-center",children:e.jsxs("button",{onClick:x,disabled:n.size===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-semibold transition-colors ${n.size===0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsxs("span",{children:["Delete Selected (",n.size,")"]})]})})]})},gt=({onAddLocation:s,workLocationCount:r,onClearAllData:t,autoStopRadius:o,onAutoStopRadiusChange:a,autoStopEnabled:n,onAutoStopEnabledChange:l,autoRecordWorkLocation:i,onAutoRecordWorkLocationChange:d})=>{const[x,p]=N.useState(!1),[m,j]=N.useState(""),u=()=>{p(!0),j("Getting your current location..."),navigator.geolocation.getCurrentPosition(f=>{const{latitude:z,longitude:Y}=f.coords;s({latitude:z,longitude:Y}),p(!1),j(`Location recorded! Total recordings: ${r+1}. The average is used as your work location.`)},f=>{p(!1),j(`Error: ${f.message}`)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{title:"AutoStop Feature",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Enable or disable automatic timer stopping when you arrive at your work location."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Enable AutoStop"}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:f=>l(f.target.checked),className:"sr-only",id:"autoStopToggle"}),e.jsx("label",{htmlFor:"autoStopToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${n?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${n?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When disabled, you will need to manually stop the timer when you arrive at work."})]})}),e.jsx($,{title:"Work Location",children:e.jsxs("div",{className:`space-y-4 ${n?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"To enable automatic arrival detection, please record your work location. You can record it multiple times for better accuracy. The application will use the average of all recorded points."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Auto-record Work Location"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Record GPS position when stopping timer"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:f=>d(f.target.checked),className:"sr-only",id:"autoRecordWorkLocationToggle",disabled:!n}),e.jsx("label",{htmlFor:"autoRecordWorkLocationToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${i&&n?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${i&&n?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, your GPS location will be automatically recorded as a work location each time you stop the commute timer."}),e.jsxs("p",{className:"text-gray-300 font-semibold",children:["Current Recordings: ",e.jsx("span",{className:"text-cyan-400",children:r})]}),e.jsx(pe,{onClick:u,disabled:x||!n,children:x?"Recording...":"Record Current Location"}),m&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:m})]})}),e.jsx($,{title:"Auto-Stop Settings",children:e.jsxs("div",{className:`space-y-4 ${n?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"Set the radius around your work location where the timer will automatically stop when you arrive."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"autoStopRadius",className:"text-gray-300 font-semibold",children:"Auto-Stop Radius"}),e.jsxs("span",{className:"text-cyan-400 font-bold",children:[o,"m"]})]}),e.jsx("input",{id:"autoStopRadius",type:"range",min:"10",max:"250",step:"10",value:o,onChange:f=>a(Number(f.target.value)),disabled:!n,className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"10m"}),e.jsx("span",{children:"250m"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Smaller radius = more precise arrival detection but may require you to be very close to your work location. Larger radius = more forgiving but may stop the timer before you actually arrive."})]})]})}),e.jsx($,{title:"Data Management",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Permanently delete all your commute records and saved work locations. This action cannot be undone."}),e.jsx(pe,{onClick:t,variant:"danger",children:"Clear All Data"})]})})]})};function ue(s,r){const[t,o]=N.useState(()=>{try{const a=window.localStorage.getItem(s);return a?JSON.parse(a):r}catch(a){return console.error(a),r}});return N.useEffect(()=>{try{const a=typeof t=="function"?t(t):t;window.localStorage.setItem(s,JSON.stringify(a))}catch(a){console.error(a)}},[s,t]),[t,o]}const pt=()=>{const[s,r]=N.useState("main"),[t,o]=ue("commuteRecords",[]),[a,n]=ue("workLocations",[]),[l,i]=ue("autoStopRadius",50),[d,x]=ue("autoStopEnabled",!0),[p,m]=ue("autoRecordWorkLocation",!1),j="0.5.0",u=N.useMemo(()=>{if(a.length===0)return null;const S=a.reduce((C,F)=>(C.latitude+=F.latitude,C.longitude+=F.longitude,C),{latitude:0,longitude:0});return{latitude:S.latitude/a.length,longitude:S.longitude/a.length}},[a]),f=N.useMemo(()=>{if(t.length<1)return null;const S=t.map(C=>C.duration);return{min:Qe(S),max:et(S),mean:fe(S),median:Re(S),stdDev:tt(S)}},[t]),z=S=>{const C={id:Date.now(),date:new Date().toISOString(),duration:S};o(F=>[...F,C].sort((I,ce)=>new Date(ce.date).getTime()-new Date(I.date).getTime()))},Y=S=>{n(C=>[...C,S])},M=S=>{o(C=>C.filter(F=>!S.includes(F.id)))},W=()=>{window.confirm("Are you sure you want to delete all commute records and work locations? This action cannot be undone.")&&(o([]),n([]),alert("All data has been cleared."))},V=()=>{switch(s){case"stats":return e.jsx(dt,{records:t,stats:f});case"history":return e.jsx(xt,{records:t,median:f?.median,onDeleteRecords:M});case"settings":return e.jsx(gt,{onAddLocation:Y,workLocationCount:a.length,onClearAllData:W,autoStopRadius:l,onAutoStopRadiusChange:i,autoStopEnabled:d,onAutoStopEnabledChange:x,autoRecordWorkLocation:p,onAutoRecordWorkLocationChange:m});case"main":default:return e.jsx(Xe,{onSaveCommute:z,workLocation:d?u:null,autoStopRadius:l,autoRecordWorkLocation:p,onAddWorkLocation:Y})}};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 font-sans flex flex-col",children:[e.jsx(Ge,{activeView:s,setView:r}),e.jsx("main",{className:"flex-grow container mx-auto p-4 md:p-6",children:V()}),e.jsx("footer",{className:"text-center p-4 text-xs text-gray-500",children:e.jsxs("p",{children:["Commute Tracker v",j,", © Johan Persson 2025"]})})]})};function ft(s={}){const{immediate:r=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:a,onRegisteredSW:n,onRegisterError:l}=s;let i,d;const x=async(m=!0)=>{await d};async function p(){if("serviceWorker"in navigator){if(i=await He(async()=>{const{Workbox:m}=await import("./vendor-CXwva4lO.js").then(j=>j.af);return{Workbox:m}},[]).then(({Workbox:m})=>new m("/commute/sw.js",{scope:"/commute/",type:"classic"})).catch(m=>{l?.(m)}),!i)return;i.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),i.addEventListener("installed",m=>{m.isUpdate||o?.()}),i.register({immediate:r}).then(m=>{n?n("/commute/sw.js",m):a?.(m)}).catch(m=>{l?.(m)})}}return d=p(),x}ft({immediate:!0,onRegistered(s){console.log("SW registered: ",s)},onRegisterError(s){console.log("SW registration error",s)}});const $e=document.getElementById("root");if(!$e)throw new Error("Could not find root element to mount to");const yt=Pe.createRoot($e);yt.render(e.jsx(ze.StrictMode,{children:e.jsx(pt,{})}));
