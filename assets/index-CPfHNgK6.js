import{a9 as e,r as N,aa as Pe,ab as ze}from"./vendor-CXwva4lO.js";import{R as ye,B as je,C as be,X as ve,Y as Ne,T as we,a as Se,b as Ae}from"./recharts-DBSh6Zai.js";import{E as Ye,a as de,_ as He}from"./jspdf-TjYnE4-S.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const xe=({label:s,viewName:a,activeView:t,setView:o,Icon:r})=>{const n=t===a;return e.jsxs("button",{onClick:()=>o(a),className:`flex flex-col items-center justify-center w-full py-2 px-1 text-xs sm:text-sm transition-colors duration-200 ${n?"text-cyan-400":"text-gray-400 hover:text-cyan-300"}`,children:[e.jsx(r,{className:"w-6 h-6 mb-1"}),e.jsx("span",{children:s})]})},Be=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Oe=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})}),Ve=s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"})}),qe=s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...s,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m18 0h-1.5"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75v.01M12 17.25v.01"})]}),Ke=({activeView:s,setView:a})=>e.jsxs("header",{className:"bg-gray-800 shadow-lg sticky top-0 z-10",children:[e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"flex justify-between items-center py-2",children:e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white tracking-wider",children:"Commute Tracker"})})}),e.jsx("nav",{className:"bg-gray-800/50 border-t border-gray-700",children:e.jsxs("div",{className:"container mx-auto flex justify-around",children:[e.jsx(xe,{label:"Timer",viewName:"main",activeView:s,setView:a,Icon:Be}),e.jsx(xe,{label:"Stats",viewName:"stats",activeView:s,setView:a,Icon:Oe}),e.jsx(xe,{label:"History",viewName:"history",activeView:s,setView:a,Icon:Ve}),e.jsx(xe,{label:"Settings",viewName:"settings",activeView:s,setView:a,Icon:qe})]})})]}),Ge=(s,a)=>{const o=s.latitude*Math.PI/180,r=a.latitude*Math.PI/180,n=(a.latitude-s.latitude)*Math.PI/180,i=(a.longitude-s.longitude)*Math.PI/180,l=Math.sin(n/2)*Math.sin(n/2)+Math.cos(o)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},_e=({workLocation:s,onStop:a,autoStopRadius:t=50,autoRecordWorkLocation:o=!1,onAddWorkLocation:r})=>{const[n,i]=N.useState(!1),[l,d]=N.useState(0),[h,p]=N.useState('Press "Leaving" to start your commute.'),[u,y]=N.useState(null),m=N.useRef(null),M=N.useRef(null);N.useEffect(()=>{const v=localStorage.getItem("commuteStartTime");if(v){const w=parseInt(v,10);i(!0),d((Date.now()-w)/1e3),p("Commute resumed...")}},[]),N.useEffect(()=>(n?m.current=window.setInterval(()=>{const v=localStorage.getItem("commuteStartTime");v&&d((Date.now()-parseInt(v,10))/1e3)},1e3):m.current&&(clearInterval(m.current),m.current=null),()=>{m.current&&clearInterval(m.current)}),[n]);const B=N.useCallback(v=>{if(!n)return;i(!1),m.current&&(clearInterval(m.current),m.current=null),M.current&&(navigator.geolocation.clearWatch(M.current),M.current=null);const w=localStorage.getItem("commuteStartTime"),z=w?parseInt(w,10):Date.now(),Y=(Date.now()-z)/1e3;localStorage.removeItem("commuteStartTime"),o&&r?navigator.geolocation.getCurrentPosition(H=>{const{latitude:k,longitude:C}=H.coords;r({latitude:k,longitude:C}),p(v||`Commute recorded! Duration: ${Math.round(Y)}s. Work location auto-recorded.`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)},H=>{console.error("Failed to record work location automatically:",H),p(v||`Commute recorded! Duration: ${Math.round(Y)}s. Failed to auto-record location.`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(p(v||`Commute recorded! Duration: ${Math.round(Y)}s`),setTimeout(()=>p('Press "Leaving" to start your commute.'),5e3)),a(Y),d(0),y(null)},[n,a,o,r]);return N.useEffect(()=>(n&&s&&(p("GPS tracking active..."),M.current=navigator.geolocation.watchPosition(v=>{const w={latitude:v.coords.latitude,longitude:v.coords.longitude},z=Ge(w,s);y(z),p(`Tracking... ${z.toFixed(0)}m to destination.`),z<t&&B("Arrived at work location automatically.")},v=>{console.error("Geolocation error:",v),p("GPS error. Tracking may be unreliable.")},{enableHighAccuracy:!0,maximumAge:0})),()=>{M.current&&navigator.geolocation.clearWatch(M.current)}),[n,s,t,B]),{isRunning:n,elapsedTime:l,startTimer:()=>{if(n)return;const v=Date.now();localStorage.setItem("commuteStartTime",v.toString()),i(!0),d(0),p("Commute started. Have a safe trip!")},stopTimer:B,statusMessage:h,distance:u}},I=({title:s,children:a,headerAction:t})=>e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm border border-gray-700 rounded-xl shadow-lg w-full max-w-2xl mx-auto",children:[s&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s}),t&&e.jsx("div",{className:"flex items-center",children:t})]}),e.jsx("div",{className:"p-4 md:p-6",children:a})]}),Ue=s=>{const a=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(a).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},Xe=({onSaveCommute:s,workLocation:a,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:r})=>{const{isRunning:n,elapsedTime:i,startTimer:l,stopTimer:d,statusMessage:h,distance:p}=_e({workLocation:a,onStop:s,autoStopRadius:t,autoRecordWorkLocation:o,onAddWorkLocation:r}),u=()=>{l()},y=()=>{d()};return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-6",children:[e.jsx(I,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-gray-400 mb-2",children:"Commute Duration"}),e.jsx("h2",{className:"text-5xl sm:text-7xl md:text-8xl font-mono font-bold tracking-widest text-cyan-400",children:Ue(i)})]})}),e.jsx("div",{className:"w-full max-w-sm flex flex-col gap-4",children:n?e.jsx("button",{onClick:y,className:"w-full bg-red-500 hover:bg-red-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Arrive"}):e.jsx("button",{onClick:u,className:"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-6 text-2xl rounded-lg shadow-lg transition-transform transform hover:scale-105",children:"Leaving"})}),e.jsxs("div",{className:"text-center text-gray-400 mt-4 h-10",children:[e.jsx("p",{children:h}),p!==null&&e.jsxs("p",{children:["Distance to work: ",p.toFixed(0),"m"]})]})]})},Ze=({records:s,binSizeMinutes:a})=>{const t=N.useMemo(()=>{if(s.length===0)return[];const r=s.map(h=>h.duration/60),n=Math.max(...r),i={};for(const h of r){const p=Math.floor(h/a)*a,u=p+a,y=`${p}-${u}`;i[y]=(i[y]||0)+1}Object.keys(i).sort((h,p)=>parseInt(h.split("-")[0])-parseInt(p.split("-")[0]));const l=Math.floor(n/a)*a,d=[];for(let h=0;h<=l;h+=a){const p=h+a,u=`${h}-${p}`;d.push({name:u,count:i[u]||0})}return d},[s,a]),o=N.useMemo(()=>{if(t.length===0)return;const r=Math.max(...t.map(n=>n.count));if(r===0)return[0];for(const n of[2,4,6,8,10,20,40,60,80,100]){const i=Math.ceil(r/n);if(i>=3&&i<=6){const l=[];for(let d=0;d<=i;d++)l.push(d*n);return l}}for(const n of[5,10,15,25,50]){const i=Math.ceil(r/n);if(i>=3&&i<=6){const l=[];for(let d=0;d<=i;d++)l.push(d*n);return l}}},[t]);return e.jsx(ye,{width:"100%",height:"100%",children:e.jsxs(je,{data:t,margin:{top:5,right:20,left:-10,bottom:5},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(ve,{dataKey:"name",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(Ne,{allowDecimals:!1,stroke:"#A0AEC0",tick:{fontSize:12},ticks:o,domain:o?[0,o[o.length-1]]:[0,"auto"]}),e.jsx(we,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#63B3ED"},formatter:r=>[`${r} trips`,"Count"],labelFormatter:r=>`Time: ${r} min`}),e.jsx(Se,{dataKey:"count",name:"Trips",children:t.map((r,n)=>e.jsx(Ae,{fill:"#2DD4BF"},`cell-${n}`))})]})})},Je=({records:s})=>{const a=N.useMemo(()=>{if(s.length===0)return[];const t={};s.forEach(r=>{const n=new Date(r.date).getHours();t[n]||(t[n]={totalDuration:0,count:0}),t[n].totalDuration+=r.duration,t[n].count++});const o=[];for(let r=0;r<24;r++){const n=t[r];n&&o.push({hour:`${String(r).padStart(2,"0")}:00`,averageDuration:n.totalDuration/n.count/60,count:n.count})}return o},[s]);return a.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No commute data to display."}):e.jsx(ye,{width:"100%",height:"100%",children:e.jsxs(je,{data:a,margin:{top:5,right:20,left:10,bottom:5},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#4A5568"}),e.jsx(ve,{dataKey:"hour",stroke:"#A0AEC0",tick:{fontSize:12}}),e.jsx(Ne,{dataKey:"averageDuration",unit:"m",stroke:"#A0AEC0",tick:{fontSize:12},width:40}),e.jsx(we,{contentStyle:{backgroundColor:"#1A202C",border:"1px solid #4A5568"},labelStyle:{color:"#E2E8F0"},itemStyle:{color:"#81E6D9"},formatter:(t,o,r)=>o==="averageDuration"?[`${t.toFixed(1)} min (average of ${r.payload.count} trips)`,"Duration"]:[t,o],labelFormatter:t=>`Time: ${t}`}),e.jsx(Se,{dataKey:"averageDuration",name:"averageDuration",children:a.map((t,o)=>e.jsx(Ae,{fill:"#81E6D9"},`cell-${o}`))})]})})},Qe=s=>s.length===0?0:Math.min(...s),et=s=>s.length===0?0:Math.max(...s),pe=s=>s.length===0?0:s.reduce((t,o)=>t+o,0)/s.length,ke=s=>{if(s.length===0)return 0;const a=[...s].sort((o,r)=>o-r),t=Math.floor(a.length/2);return a.length%2===0?(a[t-1]+a[t])/2:a[t]},tt=s=>{if(s.length<2)return 0;const a=pe(s),t=s.reduce((o,r)=>o+Math.pow(r-a,2),0)/(s.length-1);return Math.sqrt(t)},De=(s,a)=>{if(s.length===0)return 0;const t=[...s].sort((l,d)=>l-d),o=a/100*(t.length-1);if(Number.isInteger(o))return t[o];const r=Math.floor(o),n=Math.ceil(o),i=o-r;return t[r]*(1-i)+t[n]*i},Fe=(s,a)=>{if(s.length===0)return 0;const t=[...s].sort((r,n)=>r-n),o=Math.ceil(a/100*t.length)-1;return t[Math.max(0,o)]},Re=(s,a=90)=>{if(s.length<5)return null;const t=(100-a)/2,o=t,r=100-t;return{low:De(s,o),high:De(s,r)}},Le=(s,a=90)=>{if(s.length<5)return null;const t=(100-a)/2,o=t,r=100-t;return{low:Fe(s,o),high:Fe(s,r)}},st=s=>{const a=s.length;if(a<3)return null;const t=[...s].sort((m,M)=>m-M),o=pe(t),r=t.reduce((m,M)=>m+Math.pow(M-o,2),0);if(r===0)return{W:1,pValue:1,isNormal:!0};const n=new Array(a);for(let m=0;m<a;m++){const M=(m+1-.375)/(a+.25);n[m]=nt(M)}const i=n.reduce((m,M)=>m+M*M,0),l=1/Math.sqrt(i);let d=0;for(let m=0;m<a;m++)d+=n[m]*t[m];d=d*d*l*l;const h=d/r,p=Math.max(0,Math.min(1,h));if(Math.abs(h-p)>.01)return console.error(`Shapiro-Wilk W statistic out of range: ${h}`),null;const u=at(p,a),y=u>.05;return{W:p,pValue:u,isNormal:y}};function nt(s){const a=[-39.69683028665376,220.9460984245205,-275.9285104469687,138.357751867269,-30.66479806614716,2.506628277459239],t=[-54.47609879822406,161.5858368580409,-155.6989798598866,66.80131188771972,-13.28068155288572],o=[-.007784894002430293,-.3223964580411365,-2.400758277161838,-2.549732539343734,4.374664141464968,2.938163982698783],r=[.007784695709041462,.3224671290700398,2.445134137142996,3.754408661907416],n=.02425,i=1-n;if(s<n){const l=Math.sqrt(-2*Math.log(s));return(((((o[0]*l+o[1])*l+o[2])*l+o[3])*l+o[4])*l+o[5])/((((r[0]*l+r[1])*l+r[2])*l+r[3])*l+1)}else if(s<=i){const l=s-.5,d=l*l;return(((((a[0]*d+a[1])*d+a[2])*d+a[3])*d+a[4])*d+a[5])*l/(((((t[0]*d+t[1])*d+t[2])*d+t[3])*d+t[4])*d+1)}else{const l=Math.sqrt(-2*Math.log(1-s));return-(((((o[0]*l+o[1])*l+o[2])*l+o[3])*l+o[4])*l+o[5])/((((r[0]*l+r[1])*l+r[2])*l+r[3])*l+1)}}function at(s,a){if(s<=0||s>1)return 0;if(s===1)return 1;const t={20:{p01:.868,p05:.905,p10:.918},25:{p01:.888,p05:.918,p10:.928},30:{p01:.9,p05:.927,p10:.935},35:{p01:.91,p05:.934,p10:.941},40:{p01:.917,p05:.94,p10:.945},50:{p01:.927,p05:.947,p10:.951},60:{p01:.935,p05:.952,p10:.956},70:{p01:.941,p05:.956,p10:.959},80:{p01:.945,p05:.959,p10:.962},90:{p01:.949,p05:.962,p10:.964},100:{p01:.952,p05:.964,p10:.966},110:{p01:.954,p05:.966,p10:.967},120:{p01:.956,p05:.967,p10:.969},130:{p01:.958,p05:.968,p10:.97},140:{p01:.959,p05:.969,p10:.971},150:{p01:.96,p05:.97,p10:.972},160:{p01:.961,p05:.971,p10:.973},170:{p01:.962,p05:.972,p10:.974},180:{p01:.963,p05:.973,p10:.974},190:{p01:.964,p05:.973,p10:.975},200:{p01:.965,p05:.974,p10:.975},210:{p01:.965,p05:.974,p10:.976},220:{p01:.966,p05:.975,p10:.976},230:{p01:.966,p05:.975,p10:.977},240:{p01:.967,p05:.976,p10:.977},250:{p01:.967,p05:.976,p10:.978}};let o=20,r=Math.abs(a-20);for(const i of Object.keys(t).map(Number)){const l=Math.abs(a-i);l<r&&(r=l,o=i)}const n=t[o];if(s>=n.p10){const i=1-n.p10;return .1+(s-n.p10)/i*.9}else if(s>=n.p05){const i=n.p10-n.p05;return .05+(s-n.p05)/i*.05}else if(s>=n.p01){const i=n.p05-n.p01;return .01+(s-n.p01)/i*.04}else{const i=n.p01;return s/i*.01}}function We(s){return .5*(1+rt(s/Math.sqrt(2)))}function rt(s){const a=.254829592,t=-.284496736,o=1.421413741,r=-1.453152027,n=1.061405429,i=.3275911,l=s>=0?1:-1;s=Math.abs(s);const d=1/(1+i*s),h=1-((((n*d+r)*d+o)*d+t)*d+a)*d*Math.exp(-s*s);return l*h}function ot(s){const a=s.length;if(a<10)return null;let t=0;for(let p=0;p<a-1;p++)for(let u=p+1;u<a;u++){const y=s[u]-s[p];y>0?t++:y<0&&t--}const o=2*t/(a*(a-1)),r=a*(a-1)*(2*a+5)/18;let n;t>1?n=(t-1)/Math.sqrt(r):t<-1?n=(t+1)/Math.sqrt(r):n=t/Math.sqrt(r);const l=2*(1-We(Math.abs(n)));let d;l<.05?d=t>0?"increasing":"decreasing":d="no trend";let h;return l<.01?h="strong":l<.05?h="moderate":l<.1?h="weak":h="none",{S:t,tau:o,zScore:n,pValue:l,trend:d,significance:h}}function lt(s){const a=s.length;if(a<10)return null;const t=ke(s),o=s.map(m=>m>t?1:0),r=o.filter(m=>m===1).length,n=o.filter(m=>m===0).length;if(r===0||n===0)return null;let i=1;for(let m=1;m<a;m++)o[m]!==o[m-1]&&i++;const l=2*r*n/(r+n)+1,d=2*r*n*(2*r*n-r-n)/(Math.pow(r+n,2)*(r+n-1));let h;i>l?h=(i-.5-l)/Math.sqrt(d):i<l?h=(i+.5-l)/Math.sqrt(d):h=0;const p=2*(1-We(Math.abs(h)));let u;p<.05?u=i<l?"clustered":"oscillating":u="random";let y;return p<.01?y="strong":p<.05?y="moderate":p<.1?y="weak":y="none",{runs:i,expectedRuns:l,zScore:h,pValue:p,pattern:u,significance:y}}const ee=s=>{if(isNaN(s)||s<0)return"N/A";const a=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return`${String(a).padStart(2,"0")}:${String(t).padStart(2,"0")}:${String(o).padStart(2,"0")}`},it=s=>{const a=["ID","Date","Time","Duration (s)"],t=s.map(i=>{const l=new Date(i.date),d=l.toLocaleDateString(),h=l.toLocaleTimeString("en-GB",{hour12:!1});return[i.id,d,h,i.duration.toFixed(2)]});let o="data:text/csv;charset=utf-8,"+a.join(",")+`
`+t.map(i=>i.join(",")).join(`
`);const r=encodeURI(o),n=document.createElement("a");n.setAttribute("href",r),n.setAttribute("download","commute_records.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n)},ct=(s,a)=>{const t=new Ye,o=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Time Report",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const r=`Report Date: ${o}`,n=t.getTextWidth(r);t.text(r,196-n,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Statistics Summary",14,35);const i=s.map(c=>c.duration),l=s.length>=5?Re(i,90):null,d=s.length>=5?Le(i,90):null,h=[["Total Trips",s.length.toString()],["Min Duration",ee(a.min)],["Max Duration",ee(a.max)],["Mean (Average)",ee(a.mean)],["Median",ee(a.median)],["Standard Deviation",ee(a.stdDev)]];l&&d?(h.push(["",""]),h.push(["90% Confidence Interval (Interpolated)",""]),h.push(["  • Low (5th percentile)",ee(l.low)]),h.push(["  • High (95th percentile)",ee(l.high)]),h.push(["90% Confidence Interval (Nearest Rank)",""]),h.push(["  • Low (5th percentile)",ee(d.low)]),h.push(["  • High (95th percentile)",ee(d.high)])):(h.push(["",""]),h.push(["90% Confidence Intervals","Requires 5+ records"])),t.setFont("helvetica","normal"),de(t,{startY:40,head:[["Metric","Value"]],body:h,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const u=(()=>{const c=s.reduce((b,f)=>b+f.duration,0),g=new Date,S=g.getFullYear(),T=g.getMonth(),D=g.toISOString().split("T")[0],E=b=>{const f=new Date(b),G=f.getDay(),te=f.getDate()-G+(G===0?-6:1);return f.setDate(te),f.toISOString().split("T")[0]},W=E(g),V=s.filter(b=>new Date(b.date).toISOString().split("T")[0]===D).reduce((b,f)=>b+f.duration,0),Q=s.filter(b=>E(new Date(b.date))===W).reduce((b,f)=>b+f.duration,0),ae=s.filter(b=>{const f=new Date(b.date);return f.getFullYear()===S&&f.getMonth()===T}).reduce((b,f)=>b+f.duration,0),X=s.filter(b=>new Date(b.date).getFullYear()===S).reduce((b,f)=>b+f.duration,0);return{dayTotal:V,weekTotal:Q,monthTotal:ae,yearTotal:X,totalTime:c}})(),y=c=>{const g=Math.floor(c/3600),S=Math.floor(c%3600/60);return g===0?`${S} minutes`:`${g} hours ${S} minutes`};let m=t.lastAutoTable.finalY+15;t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Total Commute Time",14,m),t.setFont("helvetica","normal"),de(t,{startY:m+5,head:[["Period","Total Time"]],body:[["Today",y(u.dayTotal)],["This Week",y(u.weekTotal)],["This Month",y(u.monthTotal)],["This Year",y(u.yearTotal)],["All Time",y(u.totalTime)]],theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Commute Charts & Analysis",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const M=`Report Date: ${o}`,B=t.getTextWidth(M);t.text(M,196-B,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Commute Duration Distribution",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows how your commute times are distributed across different duration ranges.",14,45);const _=5,v={};s.forEach(c=>{const g=Math.floor(c.duration/60),S=Math.floor(g/_)*_,T=S+_,D=`${S}-${T}`;v[D]=(v[D]||0)+1});const w=Object.entries(v).sort(([c],[g])=>parseInt(c.split("-")[0])-parseInt(g.split("-")[0])),z=210,Y=153,H=(z-Y)/2,k=60,C=80,Z=Math.max(...w.map(([,c])=>c)),U=Y/w.length,he=(c=>{if(c===0)return{values:[0,0,0,0,0],numDivisions:4};const g=[2,4,6,8,10,20,40,60,80,100,200];for(const b of g){const f=Math.ceil(c/b);if(f>=3&&f<=6){const G=[],te=f*b;for(let q=0;q<=f;q++)G.push(te*q/f);return{values:G,numDivisions:f}}}const S=[5,15,25,50,150,250];for(const b of S){const f=Math.ceil(c/b);if(f>=3&&f<=6){const G=[],te=f*b;for(let q=0;q<=f;q++)G.push(te*q/f);return{values:G,numDivisions:f}}}const T=4,D=c/T,E=Math.pow(10,Math.floor(Math.log10(D))),W=D/E;let V;W<=1?V=1:W<=2?V=2:W<=5?V=5:V=10;const Q=V*E,ae=Math.ceil(c/Q)*Q,X=[];for(let b=0;b<=T;b++)X.push(ae*b/T);return{values:X,numDivisions:T}})(Z),ie=he.values,se=he.numDivisions;t.setFillColor(249,250,251),t.rect(H,k,Y,C,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(H,k,Y,C,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let c=1;c<se;c++){const g=k+C-C*c/se;t.line(H,g,H+Y,g)}w.forEach(([c,g],S)=>{const T=ie[ie.length-1],D=T>0?g/T*C:0,E=H+S*U+2,W=k+C-D;t.setFillColor(200,200,200),t.rect(E+1,W+1,U-4,D,"F"),t.setFillColor(25,51,102),t.rect(E,W,U-4,D,"F"),t.setDrawColor(15,35,70),t.setLineWidth(.5),t.rect(E,W,U-4,D,"S"),D>15?(t.setFontSize(8),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(g.toString(),E+(U-4)/2,W+D/2,{align:"center"})):D>5&&(t.setFontSize(7),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(g.toString(),E+(U-4)/2,W-2,{align:"center"}))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let c=0;c<=se;c++){const g=ie[c],S=k+C-C*c/se,T=g%1===0?g.toString():g.toFixed(1);t.text(T,H-5,S+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),w.forEach(([c],g)=>{const S=H+g*U+U/2,T=k+C+8;t.text(c.replace("-","–")+"m",S,T,{align:"center",angle:45})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",H-10,k+C/2,{align:"center",angle:90}),t.text("Duration Range (minutes)",H+Y/2,k+C+20,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Duration Histogram",H+Y/2,k-5,{align:"center"});const ce=w.map(([c,g])=>[c+" min",g.toString()]);m=k+C+35,de(t,{startY:m,head:[["Duration Range","Number of Commutes"]],body:ce,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),m=t.lastAutoTable.finalY+15,m>200&&(t.addPage(),m=20),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Time of Day Breakdown",14,m),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows when you typically commute throughout the day.",14,m+10);const J=["Early Morning (5-9)","Morning (9-12)","Afternoon (12-17)","Evening (17-21)","Night (21-5)"],$=[[216,191,140],[147,171,129],[108,141,162],[133,119,144],[89,107,125]],R={};J.forEach(c=>{R[c]=0}),s.forEach(c=>{const g=new Date(c.date).getHours();let S="";g>=5&&g<9?S="Early Morning (5-9)":g>=9&&g<12?S="Morning (9-12)":g>=12&&g<17?S="Afternoon (12-17)":g>=17&&g<21?S="Evening (17-21)":S="Night (21-5)",R[S]=(R[S]||0)+1});const oe=J.map(c=>[c,R[c]]),fe=Math.max(...oe.map(([,c])=>c)),j=(c=>{if(c===0)return{values:[0,0,0,0,0],numDivisions:4};const g=[2,4,6,8,10,20,40,60,80,100,200];for(const b of g){const f=Math.ceil(c/b);if(f>=3&&f<=6){const G=[],te=f*b;for(let q=0;q<=f;q++)G.push(te*q/f);return{values:G,numDivisions:f}}}const S=[5,15,25,50,150,250];for(const b of S){const f=Math.ceil(c/b);if(f>=3&&f<=6){const G=[],te=f*b;for(let q=0;q<=f;q++)G.push(te*q/f);return{values:G,numDivisions:f}}}const T=4,D=c/T,E=Math.pow(10,Math.floor(Math.log10(D))),W=D/E;let V;W<=1?V=1:W<=2?V=2:W<=5?V=5:V=10;const Q=V*E,ae=Math.ceil(c/Q)*Q,X=[];for(let b=0;b<=T;b++)X.push(ae*b/T);return{values:X,numDivisions:T}})(fe),F=j.values,L=j.numDivisions,A=153,P=(z-A)/2,O=m+25,K=70,ne=A/oe.length;t.setFillColor(249,250,251),t.rect(P,O,A,K,"F"),t.setDrawColor(156,163,175),t.setLineWidth(.5),t.rect(P,O,A,K,"S"),t.setDrawColor(200,200,200),t.setLineWidth(.25);for(let c=1;c<L;c++){const g=O+K-K*c/L;t.line(P,g,P+A,g)}oe.forEach(([c,g],S)=>{const T=F[F.length-1],D=T>0?g/T*K:0,E=P+S*ne+4,W=O+K-D;t.setFillColor(200,200,200),t.rect(E+1,W+1,ne-8,D,"F");const[V,Q,ae]=$[S];t.setFillColor(V,Q,ae),t.rect(E,W,ne-8,D,"F"),t.setDrawColor(V*.7,Q*.7,ae*.7),t.setLineWidth(.5),t.rect(E,W,ne-8,D,"S");const X=g;X>0&&(D>15?(t.setFontSize(10),t.setFont("helvetica","bold"),t.setTextColor(255,255,255),t.text(X.toString(),E+(ne-8)/2,W+D/2,{align:"center"})):(t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text(X.toString(),E+(ne-8)/2,W-2,{align:"center"})))}),t.setTextColor(100,100,100),t.setFontSize(10),t.setFont("helvetica","normal");for(let c=0;c<=L;c++){const g=F[c],S=O+K-K*c/L,T=g%1===0?g.toString():g.toFixed(1);t.text(T,P-5,S+1,{align:"right"})}t.setTextColor(0,0,0),t.setFontSize(9),oe.forEach(([c],g)=>{const S=P+g*ne+ne/2,T=O+K+8,D=c.split(" ")[0]+`
`+c.match(/\(([^)]+)\)/)?.[1];t.text(D,S,T,{align:"center"})}),t.setFontSize(10),t.setFont("helvetica","normal"),t.text("Number of Commutes",P-10,O+K/2,{align:"center",angle:90}),t.text("Time of Day",P+A/2,O+K+22,{align:"center"}),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Commute Time Distribution by Period",P+A/2,O-5,{align:"center"});const Ce=oe.filter(([,c])=>c>0).sort(([,c],[,g])=>g-c).map(([c,g])=>[c,g.toString()]);m=O+K+35,Ce.length>0&&de(t,{startY:m,head:[["Time Period","Number of Commutes"]],body:Ce,theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14},styles:{fontSize:10}}),t.addPage(),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("Recent Commute Records",14,20),t.setFontSize(10),t.setFont("helvetica","normal");const Me=`Report Date: ${o}`,$e=t.getTextWidth(Me);t.text(Me,196-$e,20),t.setLineWidth(.5),t.line(14,25,196,25),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Latest Commute Records",14,35),t.setFont("helvetica","normal"),t.setFontSize(10),t.text("This section shows your most recent commute records in chronological order.",14,45);const Ee=s.slice(0,25);m=55,de(t,{startY:m,head:[["Date","Time","Duration"]],body:Ee.map(c=>{const g=new Date(c.date);return[g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),g.toLocaleTimeString("en-GB",{hour12:!1}),ee(c.duration)]}),theme:"striped",headStyles:{fillColor:[25,51,102],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const Te=t.internal.getNumberOfPages();for(let c=1;c<=Te;c++)t.setPage(c),t.setFontSize(10),t.setFont("helvetica","italic"),t.text(`Page ${c} of ${Te}`,t.internal.pageSize.getWidth()/2,t.internal.pageSize.getHeight()-10,{align:"center"});t.save(`commute_report_${new Date().toISOString().split("T")[0]}.pdf`)},ge=({children:s,variant:a="primary",...t})=>{const o="font-bold py-2 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-md",r={primary:"bg-cyan-500 hover:bg-cyan-600 text-white",secondary:"bg-gray-600 hover:bg-gray-700 text-white",danger:"bg-red-600 hover:bg-red-700 text-white"};return e.jsx("button",{className:`${o} ${r[a]}`,...t,children:s})},re=s=>{if(isNaN(s)||s<0)return"N/A";const a=Math.floor(s/60),t=Math.floor(s%60);return`${a}m ${t}s`},dt=({records:s,stats:a,includeWeekends:t})=>{const[o,r]=N.useState(5),[n,i]=N.useState("median"),[l,d]=N.useState(""),[h,p]=N.useState(""),[u,y]=N.useState(""),[m,M]=N.useState(""),B=x=>x.toISOString().split("T")[0],_=x=>{const j=new Date(x),F=j.getDay(),L=j.getDate()-F+(F===0?-6:1);return new Date(j.setDate(L))},v=N.useMemo(()=>{if(s.length===0)return{days:[],weeks:[],months:[],years:[]};const x=new Set,j=new Set,F=new Set,L=new Set;return s.forEach(A=>{const P=new Date(A.date);x.add(B(P));const O=_(P);j.add(B(O));const K=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`;F.add(K),L.add(P.getFullYear().toString())}),{days:Array.from(x).sort().reverse(),weeks:Array.from(j).sort().reverse(),months:Array.from(F).sort().reverse(),years:Array.from(L).sort().reverse()}},[s]),w=(x,j)=>x==="total"?s.reduce((L,A)=>L+A.duration,0):s.filter(L=>{const A=new Date(L.date);switch(x){case"day":return j?B(A)===j:!1;case"week":if(!j)return!1;const P=_(A);return B(P)===j;case"month":return j?`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`===j:!1;case"year":return j?A.getFullYear().toString()===j:!1;default:return!1}}).reduce((L,A)=>L+A.duration,0),z=x=>{if(isNaN(x)||x<0)return"N/A";const j=Math.floor(x/3600),F=Math.floor(x%3600/60);return j===0?`${F}m`:`${j}h ${F}m`},Y=x=>{const[j,F]=x.split("-");return new Date(parseInt(j),parseInt(F)-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})},H=x=>new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),k=l?w("day",l):0,C=h?w("week",h):0,Z=u?w("month",u):0,U=m?w("year",m):0,ue=w("total");if(N.useMemo(()=>{v.days.length>0&&!l&&d(v.days[0]),v.weeks.length>0&&!h&&p(v.weeks[0]),v.months.length>0&&!u&&y(v.months[0]),v.years.length>0&&!m&&M(v.years[0])},[v,l,h,u,m]),!a)return e.jsx(I,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Not Enough Data"}),e.jsx("p",{className:"text-gray-400",children:"Complete at least one commute to see your stats."})]})});const he=()=>{it(s)},ie=()=>{a&&ct(s,a)},se=N.useMemo(()=>{if(s.length<5)return null;const x=s.map(j=>j.duration);return Re(x,90)},[s]),ce=N.useMemo(()=>{if(s.length<5)return null;const x=s.map(j=>j.duration);return Le(x,90)},[s]),J=N.useMemo(()=>{if(s.length<20)return null;const x=s.map(j=>j.duration);return st(x)},[s]),$=N.useMemo(()=>{if(s.length<10)return null;const x=s.map(j=>j.duration);return ot(x)},[s]),R=N.useMemo(()=>{if(s.length<10)return null;const x=s.map(j=>j.duration);return lt(x)},[s]),oe=N.useMemo(()=>{const x=t?["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:["Mon","Tue","Wed","Thu","Fri"],j={Mon:[],Tue:[],Wed:[],Thu:[],Fri:[],Sat:[],Sun:[]};return s.forEach(F=>{const A=new Date(F.date).getDay(),O=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][A];j[O]&&j[O].push(F.duration)}),x.map(F=>{const L=j[F];if(L.length===0)return{day:F,value:0,count:0};const A=n==="mean"?pe(L):ke(L);return{day:F,value:A/60,count:L.length}})},[s,t,n]),fe=`Statistics Summary - ${s.length} records`;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{title:fe,children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4 text-center",children:[e.jsx(me,{label:"Total Trips",value:s.length}),e.jsx(me,{label:"Min Time",value:re(a.min)}),e.jsx(me,{label:"Max Time",value:re(a.max)}),e.jsx(me,{label:"Average",value:re(a.mean)}),e.jsx(me,{label:"Median",value:re(a.median)})]})}),e.jsx(I,{title:"90% Confidence Interval (Interpolated)",children:e.jsx("div",{className:"text-center",children:se?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this range, interpolated values might not exist exactly"}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(se.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(se.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(I,{title:"90% Confidence Interval (Nearest Rank)",children:e.jsx("div",{className:"text-center",children:ce?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"90% of commutes fall within this time range, the closest actual times are used."}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Low"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:re(ce.low)})]}),e.jsx("div",{className:"text-gray-500 text-xl",children:"-"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"High"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re(ce.high)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4",children:["Based on ",s.length," recorded commutes"]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records to show 90% CI"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(I,{title:"Normality Test (Shapiro-Wilk)",children:e.jsx("div",{className:"text-center",children:J?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Tests whether commute times follow a normal (bell curve) distribution"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"W Statistic"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:J.W.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 0-1 (closer to 1 = more normal)"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"p-value"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:J.pValue.toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Significance threshold: 0.05"})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Distribution"}),e.jsx("p",{className:`text-2xl font-bold ${J.isNormal?"text-green-400":"text-yellow-400"}`,children:J.isNormal?"✓ Normal":"⚠ Not Normal"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:J.isNormal?"Data fits normal distribution":"Data deviates from normal"})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Interpretation:"}),e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:J.isNormal?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Your commute times appear to follow a normal distribution (p > 0.05). This suggests that most of your commutes cluster around the average, with fewer extremely short or long commutes. Statistical methods assuming normality are appropriate for your data."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-yellow-400",children:"⚠"})," Your commute times do not follow a normal distribution (p ≤ 0.05). This could indicate consistent factors affecting your commute (traffic patterns, weather, route changes) or the presence of outliers. Consider using non-parametric statistical methods."]})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • α = 0.05 significance level"]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 20 or more records for normality test"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 20 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Shapiro-Wilk test is most reliable with at least 20 samples"})]})})}),e.jsx(I,{title:"Total Commute Time",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Day"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:z(k)}),e.jsx("select",{value:l,onChange:x=>d(x.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.days.map(x=>e.jsx("option",{value:x,children:new Date(x).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},x))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Week"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:z(C)}),e.jsx("select",{value:h,onChange:x=>p(x.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.weeks.map(x=>e.jsxs("option",{value:x,children:["Week of ",H(x)]},x))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Month"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:z(Z)}),e.jsx("select",{value:u,onChange:x=>y(x.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.months.map(x=>e.jsx("option",{value:x,children:Y(x)},x))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Per Year"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400 mb-2",children:z(U)}),e.jsx("select",{value:m,onChange:x=>M(x.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-md p-1.5 text-xs focus:outline-none focus:ring-2 focus:ring-cyan-500",children:v.years.map(x=>e.jsx("option",{value:x,children:x},x))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Total Time"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:z(ue)}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Since start"})]})]})}),e.jsxs(I,{title:"Commute Duration Distribution",children:[e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(Ze,{records:s,binSizeMinutes:o})}),e.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-2",children:[e.jsx("label",{htmlFor:"binSize",className:"text-sm text-gray-400",children:"Bin Size (minutes):"}),e.jsxs("select",{id:"binSize",value:o,onChange:x=>r(Number(x.target.value)),className:"bg-gray-700 border border-gray-600 rounded-md p-1 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:1,children:"1"}),e.jsx("option",{value:2,children:"2"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"})]})]})]}),e.jsx(I,{title:"Commute Time by Day of Week",children:e.jsx("div",{className:"text-center",children:s.length>=5?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:[n==="median"?"Median":"Average"," commute time for each day"]}),e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(ye,{width:"100%",height:"100%",children:e.jsxs(je,{data:oe,margin:{top:10,right:30,left:0,bottom:20},children:[e.jsx(be,{strokeDasharray:"3 3",stroke:"#374151"}),e.jsx(ve,{dataKey:"day",stroke:"#9CA3AF",style:{fontSize:"0.875rem"}}),e.jsx(Ne,{stroke:"#9CA3AF",style:{fontSize:"0.875rem"},label:{value:"Minutes",angle:-90,position:"insideLeft",style:{fill:"#9CA3AF"}}}),e.jsx(we,{contentStyle:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"0.5rem",color:"#F3F4F6"},formatter:(x,j,F)=>[`${x.toFixed(1)} min (${F.payload.count} commutes)`,n==="median"?"Median":"Average"],labelStyle:{color:"#9CA3AF"}}),e.jsx(Se,{dataKey:"value",fill:"#06B6D4",radius:[8,8,0,0]})]})})}),e.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-2",children:[e.jsx("label",{htmlFor:"weekdayMetric",className:"text-sm text-gray-400",children:"Show:"}),e.jsxs("select",{id:"weekdayMetric",value:n,onChange:x=>i(x.target.value),className:"bg-gray-700 border border-gray-600 rounded-md p-1 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500",children:[e.jsx("option",{value:"median",children:"Median"}),e.jsx("option",{value:"mean",children:"Average"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:t?"Showing all days of the week. Adjust in Settings to hide weekends.":"Showing weekdays only (Mon-Fri). Enable weekends in Settings to see Sat-Sun."})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 5 or more records for weekly analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 5 required"]})]})})}),e.jsx(I,{title:"Trend Analysis (Mann-Kendall Test)",children:e.jsx("div",{className:"text-center",children:$?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Analyzes whether your commute times are getting longer, shorter, or staying stable over time"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Trend Direction"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[$.trend==="increasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📈"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:"Getting Longer"})]}),$.trend==="decreasing"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📉"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Getting Shorter"})]}),$.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"➡️"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Stable"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[$.trend==="increasing"&&"Your commute times show an upward trend",$.trend==="decreasing"&&"Your commute times show a downward trend",$.trend==="no trend"&&"No significant trend detected"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Confidence Level"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[$.significance==="strong"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"💪"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:"Very Strong"})]}),$.significance==="moderate"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"👍"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:"Moderate"})]}),$.significance==="weak"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤔"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:"Weak"})]}),$.significance==="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🤷"}),e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Not Significant"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["p-value: ",$.pValue.toFixed(4)]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[$.trend==="increasing"&&$.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-400",children:"⚠️"})," Your commute times are trending ",e.jsx("strong",{children:"upward"}),". This could indicate increasing traffic congestion, seasonal changes, or route deterioration. Consider exploring alternative routes or adjusting your departure time."]}),$.trend==="decreasing"&&$.significance!=="none"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-400",children:"✓"})," Great news! Your commute times are trending ",e.jsx("strong",{children:"downward"}),". This suggests improvements in traffic flow, better route choices, or favorable seasonal changes. Keep up whatever you're doing!"]}),$.trend==="no trend"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"➡️"})," Your commute times remain ",e.jsx("strong",{children:"stable"})," over time. This consistency suggests predictable traffic patterns and reliable route conditions. Good for planning your schedule!"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • Kendall's τ = ",$.tau.toFixed(3)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for trend analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Mann-Kendall test detects monotonic trends in time series data"})]})})}),e.jsx(I,{title:"Pattern Analysis (Runs Test)",children:e.jsx("div",{className:"text-center",children:R?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Detects whether your commute times follow a random pattern or show clustering/oscillation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Pattern Type"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2",children:[R.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🎲"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:"Random"})]}),R.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"📦"}),e.jsx("p",{className:"text-2xl font-bold text-orange-400",children:"Clustered"})]}),R.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-4xl",children:"🌊"}),e.jsx("p",{className:"text-2xl font-bold text-purple-400",children:"Oscillating"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[R.pattern==="random"&&"No predictable pattern detected",R.pattern==="clustered"&&"Similar times grouped together",R.pattern==="oscillating"&&"Alternating fast/slow pattern"]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Runs Analysis"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:["Observed: ",e.jsx("span",{className:"font-bold text-cyan-400",children:R.runs})]}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Expected: ",e.jsx("span",{className:"font-bold text-gray-400",children:R.expectedRuns.toFixed(1)})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[R.significance==="strong"&&"(Very Strong Evidence)",R.significance==="moderate"&&"(Moderate Evidence)",R.significance==="weak"&&"(Weak Evidence)",R.significance==="none"&&"(Not Statistically Significant)"]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-300 mb-2",children:"What does this mean?"}),e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:[R.pattern==="random"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-cyan-400",children:"🎲"})," Your commute times appear ",e.jsx("strong",{children:"random"}),", with no clear pattern of clustering or alternation. This is typical when traffic conditions vary independently from day to day. Each commute is relatively unpredictable."]}),R.pattern==="clustered"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-orange-400",children:"📦"})," Your commute times show ",e.jsx("strong",{children:"clustering"}),", meaning you tend to have stretches of similar commute times (several fast days followed by several slow days). This could indicate weekly patterns, weather impacts, or consistent schedule changes."]}),R.pattern==="oscillating"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-purple-400",children:"🌊"})," Your commute times show an ",e.jsx("strong",{children:"oscillating pattern"}),", alternating between faster and slower commutes more than expected by chance. This could suggest alternating schedules, every-other-day traffic patterns, or behavioral factors affecting your timing."]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Based on ",s.length," recorded commutes • p-value: ",R.pValue.toFixed(4)]})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("p",{className:"text-gray-400 text-lg",children:"Needs 10 or more records for pattern analysis"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Currently ",s.length," of 10 required"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"The Runs Test detects non-random patterns in sequential data"})]})})}),e.jsx(I,{title:"Time of Day Breakdown",children:e.jsx("div",{className:"h-64 md:h-80",children:e.jsx(Je,{records:s})})}),e.jsx(I,{title:"Export Data",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsx("p",{className:"text-gray-400 flex-grow text-center sm:text-left mb-4 sm:mb-0",children:"Export your commute history as a CSV or a PDF summary report."}),e.jsxs("div",{className:"flex gap-4 flex-shrink-0",children:[e.jsx(ge,{onClick:he,children:"Export to CSV"}),e.jsx(ge,{onClick:ie,children:"Export to PDF"})]})]})})]})},me=({label:s,value:a})=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400",children:s}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:a})]}),mt=s=>{if(isNaN(s)||s<0)return"N/A";const a=Math.floor(s/3600),t=Math.floor(s%3600/60),o=Math.floor(s%60);return[a>0?`${a}h`:"",t>0?`${t}m`:"",`${o}s`].filter(Boolean).join(" ")||"0s"},ut=(s,a)=>{if(!a||a===0)return"hsl(210, 15%, 50%)";const t=a*.5,o=a*1.5;return`hsl(${120-(Math.max(t,Math.min(o,s))-t)/(o-t)*120}, 70%, 45%)`},ht=({record:s,median:a,isEditMode:t,isSelected:o,onSelect:r})=>{const n=a?ut(s.duration,a):"hsl(210, 15%, 50%)";return e.jsxs("li",{className:"py-4 px-2 flex flex-col sm:flex-row sm:items-center sm:justify-between hover:bg-gray-700/50 rounded-lg transition-colors duration-200",children:[t&&e.jsx("div",{className:"flex items-center mr-4",children:e.jsx("input",{type:"checkbox",checked:o,onChange:i=>r(s.id,i.target.checked),className:"w-4 h-4 text-red-600 bg-gray-700 border-gray-600 rounded focus:ring-red-500 focus:ring-2"})}),e.jsxs("div",{className:"flex-1 mb-2 sm:mb-0 pr-4",children:[e.jsx("p",{className:"font-semibold text-gray-200",children:mt(s.duration)}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(s.date).toLocaleString("en-GB",{hour12:!1})})]}),e.jsx("div",{className:"w-full sm:w-1/2 h-2.5 bg-gray-600 rounded-full overflow-hidden",title:"Comparison to median commute time",children:e.jsx("div",{className:"h-full rounded-full",style:{backgroundColor:n,width:"100%"}})})]})},xt=({records:s,median:a,onDeleteRecords:t})=>{const[o,r]=N.useState(!1),[n,i]=N.useState(new Set);if(s.length===0)return e.jsx(I,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No History Yet"}),e.jsx("p",{className:"text-gray-400",children:"Your completed commutes will appear here."})]})});const l=()=>{r(!o),i(new Set)},d=(u,y)=>{const m=new Set(n);y?m.add(u):m.delete(u),i(m)},h=()=>{if(n.size===0){alert("Please select at least one record to delete.");return}const u=n.size,y=`Are you sure you want to delete ${u} selected record${u===1?"":"s"}? This action cannot be undone.`;window.confirm(y)&&(t(Array.from(n)),i(new Set),r(!1))},p=()=>{n.size===s.length?i(new Set):i(new Set(s.map(u=>u.id)))};return e.jsxs(I,{title:"Commute History",headerAction:e.jsxs("div",{className:"flex items-center space-x-2",children:[o&&n.size>0&&e.jsx("button",{onClick:p,className:"text-xs text-cyan-400 hover:text-cyan-300 transition-colors",children:n.size===s.length?"Deselect All":"Select All"}),e.jsx("button",{onClick:l,className:"p-2 text-gray-400 hover:text-gray-200 transition-colors",title:o?"Exit edit mode":"Edit records",children:o?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]}),children:[e.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-gray-700",children:s.map(u=>e.jsx(ht,{record:u,median:a,isEditMode:o,isSelected:n.has(u.id),onSelect:d},u.id))})}),o&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700 flex justify-center",children:e.jsxs("button",{onClick:h,disabled:n.size===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-semibold transition-colors ${n.size===0?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),e.jsxs("span",{children:["Delete Selected (",n.size,")"]})]})})]})},gt=({onAddLocation:s,workLocationCount:a,onClearAllData:t,autoStopRadius:o,onAutoStopRadiusChange:r,autoStopEnabled:n,onAutoStopEnabledChange:i,autoRecordWorkLocation:l,onAutoRecordWorkLocationChange:d,includeWeekends:h,onIncludeWeekendsChange:p})=>{const[u,y]=N.useState(!1),[m,M]=N.useState(""),[B,_]=N.useState(!1),v=()=>{y(!0),M("Getting your current location..."),navigator.geolocation.getCurrentPosition(w=>{const{latitude:z,longitude:Y}=w.coords;s({latitude:z,longitude:Y}),y(!1),M(`Location recorded! Total recordings: ${a+1}. The average is used as your work location.`)},w=>{y(!1),M(`Error: ${w.message}`)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{title:"AutoStop Feature",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Enable or disable automatic timer stopping when you arrive at your work location."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Enable AutoStop"}),e.jsxs("div",{className:"relative inline-block w-12 h-6",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:w=>i(w.target.checked),className:"sr-only",id:"autoStopToggle"}),e.jsx("label",{htmlFor:"autoStopToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${n?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${n?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When disabled, you will need to manually stop the timer when you arrive at work."})]})}),e.jsx(I,{title:"Work Location",children:e.jsxs("div",{className:`space-y-4 ${n?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"To enable automatic arrival detection, please record your work location. You can record it multiple times for better accuracy. The application will use the average of all recorded points."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Auto-record Work Location"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Record GPS position when stopping timer"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:w=>d(w.target.checked),className:"sr-only",id:"autoRecordWorkLocationToggle",disabled:!n}),e.jsx("label",{htmlFor:"autoRecordWorkLocationToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${l&&n?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${l&&n?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, your GPS location will be automatically recorded as a work location each time you stop the commute timer."}),e.jsxs("p",{className:"text-gray-300 font-semibold",children:["Current Recordings: ",e.jsx("span",{className:"text-cyan-400",children:a})]}),e.jsx(ge,{onClick:v,disabled:u||!n,children:u?"Recording...":"Record Current Location"}),m&&e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:m})]})}),e.jsx(I,{title:"Auto-Stop Settings",children:e.jsxs("div",{className:`space-y-4 ${n?"":"opacity-50 pointer-events-none"}`,children:[e.jsx("p",{className:"text-gray-400",children:"Set the radius around your work location where the timer will automatically stop when you arrive."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{htmlFor:"autoStopRadius",className:"text-gray-300 font-semibold",children:"Auto-Stop Radius"}),e.jsxs("span",{className:"text-cyan-400 font-bold",children:[o,"m"]})]}),e.jsx("input",{id:"autoStopRadius",type:"range",min:"10",max:"250",step:"10",value:o,onChange:w=>r(Number(w.target.value)),disabled:!n,className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"10m"}),e.jsx("span",{children:"250m"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Smaller radius = more precise arrival detection but may require you to be very close to your work location. Larger radius = more forgiving but may stop the timer before you actually arrive."})]})]})}),e.jsx(I,{title:"Statistics Display",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Configure how data is displayed in the Statistics view."}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("span",{className:"text-gray-300 font-semibold",children:"Include Weekends in Day-of-Week Chart"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show Saturday and Sunday in weekly pattern analysis"})]}),e.jsxs("div",{className:"relative inline-block w-12 h-6 flex-shrink-0",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:w=>p(w.target.checked),className:"sr-only",id:"includeWeekendsToggle"}),e.jsx("label",{htmlFor:"includeWeekendsToggle",className:`block w-12 h-6 rounded-full cursor-pointer transition-colors duration-200 ${h?"bg-cyan-500":"bg-gray-600"}`,children:e.jsx("span",{className:`block w-4 h-4 bg-white rounded-full shadow-md transform transition-transform duration-200 mt-1 ${h?"translate-x-7":"translate-x-1"}`})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"When enabled, the day-of-week chart will include weekend data. Most users only commute on weekdays."})]})}),e.jsx(I,{title:"Data Management",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-400",children:"Permanently delete all your commute records and saved work locations. This action cannot be undone."}),e.jsx(ge,{onClick:t,variant:"danger",children:"Clear All Data"})]})}),e.jsx(I,{title:"About",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("span",{className:"text-6xl",children:"ℹ️"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-cyan-400 mb-2",children:"Commute Tracker"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"A Progressive Web App for tracking and analyzing your daily commute times"})]}),e.jsx("button",{onClick:()=>_(!B),className:"w-full flex items-center justify-between bg-gray-800 p-3 rounded-lg hover:bg-gray-750 transition-colors",children:e.jsx("span",{className:"text-gray-300 font-semibold",children:B?"▼ Hide Details":"▶ Show Details"})}),B&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Technologies & Libraries"}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"React"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"19.2.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TypeScript"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"5.2.2"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Vite"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"7.1.12"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"TailwindCSS"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.4.18"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Recharts"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.3.0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"jsPDF"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"3.0.3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"PWA (vite-plugin-pwa)"}),e.jsx("span",{className:"text-cyan-400 font-mono",children:"1.1.0"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Features"}),e.jsx("div",{className:"bg-gray-800 p-3 rounded-lg",children:e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[e.jsx("li",{children:"• Real-time GPS-based commute tracking"}),e.jsx("li",{children:"• Automatic arrival detection"}),e.jsx("li",{children:"• Statistical analysis (Shapiro-Wilk, Mann-Kendall, Runs Test)"}),e.jsx("li",{children:"• Interactive charts and histograms"}),e.jsx("li",{children:"• CSV and PDF export capabilities"}),e.jsx("li",{children:"• Offline support via PWA"}),e.jsx("li",{children:"• Local storage (no server required)"})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"License"}),e.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:e.jsx("span",{className:"font-semibold text-cyan-400",children:"MIT License"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Open source software that you can use, modify, and distribute freely."})]})]}),e.jsxs("div",{className:"text-center pt-4 border-t border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"© 2025 Johan Persson"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All rights reserved"})]})]})]})})]})};function le(s,a){const[t,o]=N.useState(()=>{try{const r=window.localStorage.getItem(s);return r?JSON.parse(r):a}catch(r){return console.error(r),a}});return N.useEffect(()=>{try{const r=typeof t=="function"?t(t):t;window.localStorage.setItem(s,JSON.stringify(r))}catch(r){console.error(r)}},[s,t]),[t,o]}const pt=()=>{const[s,a]=N.useState("main"),[t,o]=le("commuteRecords",[]),[r,n]=le("workLocations",[]),[i,l]=le("autoStopRadius",50),[d,h]=le("autoStopEnabled",!0),[p,u]=le("autoRecordWorkLocation",!1),[y,m]=le("includeWeekends",!1),M="0.6.0",B=N.useMemo(()=>{if(r.length===0)return null;const k=r.reduce((C,Z)=>(C.latitude+=Z.latitude,C.longitude+=Z.longitude,C),{latitude:0,longitude:0});return{latitude:k.latitude/r.length,longitude:k.longitude/r.length}},[r]),_=N.useMemo(()=>{if(t.length<1)return null;const k=t.map(C=>C.duration);return{min:Qe(k),max:et(k),mean:pe(k),median:ke(k),stdDev:tt(k)}},[t]),v=k=>{const C={id:Date.now(),date:new Date().toISOString(),duration:k};o(Z=>[...Z,C].sort((U,ue)=>new Date(ue.date).getTime()-new Date(U.date).getTime()))},w=k=>{n(C=>[...C,k])},z=k=>{o(C=>C.filter(Z=>!k.includes(Z.id)))},Y=()=>{window.confirm("Are you sure you want to delete all commute records and work locations? This action cannot be undone.")&&(o([]),n([]),alert("All data has been cleared."))},H=()=>{switch(s){case"stats":return e.jsx(dt,{records:t,stats:_,includeWeekends:y});case"history":return e.jsx(xt,{records:t,median:_?.median,onDeleteRecords:z});case"settings":return e.jsx(gt,{onAddLocation:w,workLocationCount:r.length,onClearAllData:Y,autoStopRadius:i,onAutoStopRadiusChange:l,autoStopEnabled:d,onAutoStopEnabledChange:h,autoRecordWorkLocation:p,onAutoRecordWorkLocationChange:u,includeWeekends:y,onIncludeWeekendsChange:m});case"main":default:return e.jsx(Xe,{onSaveCommute:v,workLocation:d?B:null,autoStopRadius:i,autoRecordWorkLocation:p,onAddWorkLocation:w})}};return e.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100 font-sans flex flex-col",children:[e.jsx(Ke,{activeView:s,setView:a}),e.jsx("main",{className:"flex-grow container mx-auto p-4 md:p-6",children:H()}),e.jsx("footer",{className:"text-center p-4 text-xs text-gray-500",children:e.jsxs("p",{children:["Commute Tracker v",M,", © Johan Persson 2025"]})})]})};function ft(s={}){const{immediate:a=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:r,onRegisteredSW:n,onRegisterError:i}=s;let l,d;const h=async(u=!0)=>{await d};async function p(){if("serviceWorker"in navigator){if(l=await He(async()=>{const{Workbox:u}=await import("./vendor-CXwva4lO.js").then(y=>y.af);return{Workbox:u}},[]).then(({Workbox:u})=>new u("/commute/sw.js",{scope:"/commute/",type:"classic"})).catch(u=>{i?.(u)}),!l)return;l.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),l.addEventListener("installed",u=>{u.isUpdate||o?.()}),l.register({immediate:a}).then(u=>{n?n("/commute/sw.js",u):r?.(u)}).catch(u=>{i?.(u)})}}return d=p(),h}ft({immediate:!0,onRegistered(s){console.log("SW registered: ",s)},onRegisterError(s){console.log("SW registration error",s)}});const Ie=document.getElementById("root");if(!Ie)throw new Error("Could not find root element to mount to");const yt=Pe.createRoot(Ie);yt.render(e.jsx(ze.StrictMode,{children:e.jsx(pt,{})}));
